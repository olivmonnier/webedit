!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){module.exports=function(a,n){return Array.prototype.slice.call(a,n)}},{}],2:[function(require,module,exports){(function(global){!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.basicModal=n()}}(function(){return function n(t,e,o){function l(c,s){if(!e[c]){if(!t[c]){var i="function"==typeof require&&require;if(!s&&i)return i(c,!0);if(a)return a(c,!0);var r=new Error("Cannot find module '"+c+"'");throw r.code="MODULE_NOT_FOUND",r}var u=e[c]={exports:{}};t[c][0].call(u.exports,function(n){var e=t[c][1][n];return l(e?e:n)},u,u.exports,n,t,e,o)}return e[c].exports}for(var a="function"==typeof require&&require,c=0;c<o.length;c++)l(o[c]);return l}({1:[function(n,t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=null,l=(e.THEME={small:"basicModal__small",xclose:"basicModal__xclose"},function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t===!0?document.querySelectorAll(".basicModal "+n):document.querySelector(".basicModal "+n)}),a=function(n,t){return null!=n&&(n.constructor===Object?Array.prototype.forEach.call(Object.keys(n),function(e){return t(n[e],e,n)}):Array.prototype.forEach.call(n,function(e,o){return t(e,o,n)}))},c=function(n){return null==n||0===Object.keys(n).length?(console.error("Missing or empty modal configuration object"),!1):(null==n.body&&(n.body=""),null==n.class&&(n.class=""),n.closable!==!1&&(n.closable=!0),null==n.buttons?(console.error("basicModal requires at least one button"),!1):null!=n.buttons.action&&(null==n.buttons.action.class&&(n.buttons.action.class=""),null==n.buttons.action.title&&(n.buttons.action.title="OK"),null==n.buttons.action.fn)?(console.error("Missing fn for action-button"),!1):null==n.buttons.cancel||(null==n.buttons.cancel.class&&(n.buttons.cancel.class=""),null==n.buttons.cancel.title&&(n.buttons.cancel.title="Cancel"),null!=n.buttons.cancel.fn)||(console.error("Missing fn for cancel-button"),!1))},s=function(n){var t='<svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><path d="M405 136.798l-29.798-29.798-119.202 119.202-119.202-119.202-29.798 29.798 119.202 119.202-119.202 119.202 29.798 29.798 119.202-119.202 119.202 119.202 29.798-29.798-119.202-119.202z"/></svg>',e="";return e+="\n\t        <div class='basicModalContainer basicModalContainer--fadeIn' data-closable='"+n.closable+"'>\n\t            <div class='basicModal basicModal--fadeIn "+n.class+"' role=\"dialog\">\n\t                <div class='basicModal__content'>\n\t                    "+n.body+"\n\t                </div>\n\t                <div class='basicModal__buttons'>\n\t        ",null!=n.buttons.cancel&&(e+=n.buttons.cancel.class.indexOf("basicModal__xclose")===-1?"<a id='basicModal__cancel' class='basicModal__button "+n.buttons.cancel.class+"'>"+n.buttons.cancel.title+"</a>":"<div id='basicModal__cancel' class='basicModal__button "+n.buttons.cancel.class+"' aria-label='close'>"+t+"</div>"),null!=n.buttons.action&&(e+="<a id='basicModal__action' class='basicModal__button "+n.buttons.action.class+"'>"+n.buttons.action.title+"</a>"),e+="\n\t                </div>\n\t            </div>\n\t        </div>\n\t        "},i=e.getValues=function(){var n={},t=l("input[name]",!0),e=l("select[name]",!0);return a(t,function(t){var e=t.getAttribute("name"),o=t.value;n[e]=o}),a(e,function(t){var e=t.getAttribute("name"),o=t.options[t.selectedIndex].value;n[e]=o}),0===Object.keys(n).length?null:n},r=function(n){return null!=n.buttons.cancel&&(l("#basicModal__cancel").onclick=function(){return this.classList.contains("basicModal__button--active")!==!0&&(this.classList.add("basicModal__button--active"),void n.buttons.cancel.fn())}),null!=n.buttons.action&&(l("#basicModal__action").onclick=function(){return this.classList.contains("basicModal__button--active")!==!0&&(this.classList.add("basicModal__button--active"),void n.buttons.action.fn(i()))}),a(l("input",!0),function(n){n.oninput=n.onblur=function(){this.classList.remove("error")}}),a(l("select",!0),function(n){n.onchange=n.onblur=function(){this.classList.remove("error")}}),!0},u=(e.show=function n(t){if(c(t)===!1)return!1;if(null!=l())return b(!0),setTimeout(function(){return n(t)},301),!1;o=document.activeElement;var e=s(t);document.body.insertAdjacentHTML("beforeend",e),r(t);var a=l("input");null!=a&&a.select();var i=l("select");return null==a&&null!=i&&i.focus(),null!=t.callback&&t.callback(t),!0},e.error=function(n){d();var t=l("input[name='"+n+"']")||l("select[name='"+n+"']");return null!=t&&(t.classList.add("error"),"function"==typeof t.select?t.select():t.focus(),l().classList.remove("basicModal--fadeIn","basicModal--shake"),void setTimeout(function(){return l().classList.add("basicModal--shake")},1))},e.visible=function(){return null!=l()}),d=(e.action=function(){var n=l("#basicModal__action");return null!=n&&(n.click(),!0)},e.cancel=function(){var n=l("#basicModal__cancel");return null!=n&&(n.click(),!0)},e.reset=function(){var n=l(".basicModal__button",!0);a(n,function(n){return n.classList.remove("basicModal__button--active")});var t=l("input",!0);a(t,function(n){return n.classList.remove("error")});var e=l("select",!0);return a(e,function(n){return n.classList.remove("error")}),!0}),b=e.close=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(u()===!1)return!1;var t=l().parentElement;return("false"!==t.getAttribute("data-closable")||n!==!1)&&(t.classList.remove("basicModalContainer--fadeIn"),t.classList.add("basicModalContainer--fadeOut"),setTimeout(function(){return null!=t&&null!=t.parentElement&&void t.parentElement.removeChild(t)},300),null!=o&&(o.focus(),o=null),!0)}},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(require,module,exports){"use strict";var ticky=require("ticky");module.exports=function(fn,args,ctx){fn&&ticky(function(){fn.apply(ctx||null,args||[])})}},{ticky:14}],4:[function(require,module,exports){"use strict";var atoa=require("atoa"),debounce=require("./debounce");module.exports=function(thing,options){var opts=options||{},evt={};return void 0===thing&&(thing={}),thing.on=function(type,fn){return evt[type]?evt[type].push(fn):evt[type]=[fn],thing},thing.once=function(type,fn){return fn._once=!0,thing.on(type,fn),thing},thing.off=function(type,fn){var c=arguments.length;if(1===c)delete evt[type];else if(0===c)evt={};else{var et=evt[type];if(!et)return thing;et.splice(et.indexOf(fn),1)}return thing},thing.emit=function(){var args=atoa(arguments);return thing.emitterSnapshot(args.shift()).apply(this,args)},thing.emitterSnapshot=function(type){var et=(evt[type]||[]).slice(0);return function(){var args=atoa(arguments),ctx=this||thing;if("error"===type&&opts.throws!==!1&&!et.length)throw 1===args.length?args[0]:args;return et.forEach(function(listen){opts.async?debounce(listen,args,ctx):listen.apply(ctx,args),listen._once&&thing.off(type,listen)}),thing}},thing}},{"./debounce":3,atoa:1}],5:[function(require,module,exports){(function(global){"use strict";function addEventEasy(el,type,fn,capturing){return el.addEventListener(type,fn,capturing)}function addEventHard(el,type,fn){return el.attachEvent("on"+type,wrap(el,type,fn))}function removeEventEasy(el,type,fn,capturing){return el.removeEventListener(type,fn,capturing)}function removeEventHard(el,type,fn){var listener=unwrap(el,type,fn);if(listener)return el.detachEvent("on"+type,listener)}function fabricateEvent(el,type,model){function makeClassicEvent(){var e;return doc.createEvent?(e=doc.createEvent("Event"),e.initEvent(type,!0,!0)):doc.createEventObject&&(e=doc.createEventObject()),e}function makeCustomEvent(){return new customEvent(type,{detail:model})}var e=eventmap.indexOf(type)===-1?makeCustomEvent():makeClassicEvent();el.dispatchEvent?el.dispatchEvent(e):el.fireEvent("on"+type,e)}function wrapperFactory(el,type,fn){return function(originalEvent){var e=originalEvent||global.event;e.target=e.target||e.srcElement,e.preventDefault=e.preventDefault||function(){e.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){e.cancelBubble=!0},e.which=e.which||e.keyCode,fn.call(el,e)}}function wrap(el,type,fn){var wrapper=unwrap(el,type,fn)||wrapperFactory(el,type,fn);return hardCache.push({wrapper:wrapper,element:el,type:type,fn:fn}),wrapper}function unwrap(el,type,fn){var i=find(el,type,fn);if(i){var wrapper=hardCache[i].wrapper;return hardCache.splice(i,1),wrapper}}function find(el,type,fn){var i,item;for(i=0;i<hardCache.length;i++)if(item=hardCache[i],item.element===el&&item.type===type&&item.fn===fn)return i}var customEvent=require("custom-event"),eventmap=require("./eventmap"),doc=global.document,addEvent=addEventEasy,removeEvent=removeEventEasy,hardCache=[];global.addEventListener||(addEvent=addEventHard,removeEvent=removeEventHard),module.exports={add:addEvent,remove:removeEvent,fabricate:fabricateEvent}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":6,"custom-event":7}],6:[function(require,module,exports){(function(global){"use strict";var eventmap=[],eventname="",ron=/^on/;for(eventname in global)ron.test(eventname)&&eventmap.push(eventname.slice(2));module.exports=eventmap}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(require,module,exports){(function(global){function useNative(){try{var p=new NativeCustomEvent("cat",{detail:{foo:"bar"}});return"cat"===p.type&&"bar"===p.detail.foo}catch(e){}return!1}var NativeCustomEvent=global.CustomEvent;module.exports=useNative()?NativeCustomEvent:"function"==typeof document.createEvent?function(type,params){var e=document.createEvent("CustomEvent");return params?e.initCustomEvent(type,params.bubbles,params.cancelable,params.detail):e.initCustomEvent(type,!1,!1,void 0),e}:function(type,params){var e=document.createEventObject();return e.type=type,params?(e.bubbles=Boolean(params.bubbles),e.cancelable=Boolean(params.cancelable),e.detail=params.detail):(e.bubbles=!1,e.cancelable=!1,e.detail=void 0),e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(require,module,exports){"use strict";function lookupClass(className){var cached=cache[className];return cached?cached.lastIndex=0:cache[className]=cached=new RegExp(start+className+end,"g"),cached}function addClass(el,className){var current=el.className;current.length?lookupClass(className).test(current)||(el.className+=" "+className):el.className=className}function rmClass(el,className){el.className=el.className.replace(lookupClass(className)," ").trim()}var cache={},start="(?:^|\\s)",end="(?:\\s|$)";module.exports={add:addClass,rm:rmClass}},{}],9:[function(require,module,exports){(function(global){"use strict";function dragula(initialContainers,options){function isContainer(el){return drake.containers.indexOf(el)!==-1||o.isContainer(el)}function events(remove){var op=remove?"remove":"add";touchy(documentElement,op,"mousedown",grab),touchy(documentElement,op,"mouseup",release)}function eventualMovements(remove){var op=remove?"remove":"add";touchy(documentElement,op,"mousemove",startBecauseMouseMoved)}function movements(remove){var op=remove?"remove":"add";crossvent[op](documentElement,"selectstart",preventGrabbed),crossvent[op](documentElement,"click",preventGrabbed)}function destroy(){events(!0),release({})}function preventGrabbed(e){_grabbed&&e.preventDefault()}function grab(e){_moveX=e.clientX,_moveY=e.clientY;var ignore=1!==whichMouseButton(e)||e.metaKey||e.ctrlKey;if(!ignore){var item=e.target,context=canStart(item);context&&(_grabbed=context,eventualMovements(),"mousedown"===e.type&&(isInput(item)?item.focus():e.preventDefault()))}}function startBecauseMouseMoved(e){if(_grabbed){if(0===whichMouseButton(e))return void release({});if(void 0===e.clientX||e.clientX!==_moveX||void 0===e.clientY||e.clientY!==_moveY){if(o.ignoreInputTextSelection){var clientX=getCoord("clientX",e),clientY=getCoord("clientY",e),elementBehindCursor=doc.elementFromPoint(clientX,clientY);if(isInput(elementBehindCursor))return}var grabbed=_grabbed;eventualMovements(!0),movements(),end(),start(grabbed);var offset=getOffset(_item);_offsetX=getCoord("pageX",e)-offset.left,_offsetY=getCoord("pageY",e)-offset.top,classes.add(_copy||_item,"gu-transit"),renderMirrorImage(),drag(e)}}}function canStart(item){if(!(drake.dragging&&_mirror||isContainer(item))){for(var handle=item;getParent(item)&&isContainer(getParent(item))===!1;){if(o.invalid(item,handle))return;if(item=getParent(item),!item)return}var source=getParent(item);if(source&&!o.invalid(item,handle)){var movable=o.moves(item,source,handle,nextEl(item));if(movable)return{item:item,source:source}}}}function canMove(item){return!!canStart(item)}function manualStart(item){var context=canStart(item);context&&start(context)}function start(context){isCopy(context.item,context.source)&&(_copy=context.item.cloneNode(!0),drake.emit("cloned",_copy,context.item,"copy")),_source=context.source,_item=context.item,_initialSibling=_currentSibling=nextEl(context.item),drake.dragging=!0,drake.emit("drag",_item,_source)}function invalidTarget(){return!1}function end(){if(drake.dragging){var item=_copy||_item;drop(item,getParent(item))}}function ungrab(){_grabbed=!1,eventualMovements(!0),movements(!0)}function release(e){if(ungrab(),drake.dragging){var item=_copy||_item,clientX=getCoord("clientX",e),clientY=getCoord("clientY",e),elementBehindCursor=getElementBehindPoint(_mirror,clientX,clientY),dropTarget=findDropTarget(elementBehindCursor,clientX,clientY);dropTarget&&(_copy&&o.copySortSource||!_copy||dropTarget!==_source)?drop(item,dropTarget):o.removeOnSpill?remove():cancel()}}function drop(item,target){var parent=getParent(item);_copy&&o.copySortSource&&target===_source&&parent.removeChild(_item),isInitialPlacement(target)?drake.emit("cancel",item,_source,_source):drake.emit("drop",item,target,_source,_currentSibling),cleanup()}function remove(){if(drake.dragging){var item=_copy||_item,parent=getParent(item);parent&&parent.removeChild(item),drake.emit(_copy?"cancel":"remove",item,parent,_source),cleanup()}}function cancel(revert){if(drake.dragging){var reverts=arguments.length>0?revert:o.revertOnSpill,item=_copy||_item,parent=getParent(item),initial=isInitialPlacement(parent);initial===!1&&reverts&&(_copy?parent&&parent.removeChild(_copy):_source.insertBefore(item,_initialSibling)),initial||reverts?drake.emit("cancel",item,_source,_source):drake.emit("drop",item,parent,_source,_currentSibling),cleanup()}}function cleanup(){var item=_copy||_item;ungrab(),removeMirrorImage(),item&&classes.rm(item,"gu-transit"),_renderTimer&&clearTimeout(_renderTimer),drake.dragging=!1,_lastDropTarget&&drake.emit("out",item,_lastDropTarget,_source),drake.emit("dragend",item),_source=_item=_copy=_initialSibling=_currentSibling=_renderTimer=_lastDropTarget=null}function isInitialPlacement(target,s){var sibling;return sibling=void 0!==s?s:_mirror?_currentSibling:nextEl(_copy||_item),target===_source&&sibling===_initialSibling}function findDropTarget(elementBehindCursor,clientX,clientY){function accepted(){var droppable=isContainer(target);if(droppable===!1)return!1;var immediate=getImmediateChild(target,elementBehindCursor),reference=getReference(target,immediate,clientX,clientY),initial=isInitialPlacement(target,reference);return!!initial||o.accepts(_item,target,_source,reference)}for(var target=elementBehindCursor;target&&!accepted();)target=getParent(target);return target}function drag(e){function moved(type){drake.emit(type,item,_lastDropTarget,_source)}function over(){changed&&moved("over")}function out(){_lastDropTarget&&moved("out")}if(_mirror){e.preventDefault();var clientX=getCoord("clientX",e),clientY=getCoord("clientY",e),x=clientX-_offsetX,y=clientY-_offsetY;_mirror.style.left=x+"px",_mirror.style.top=y+"px";var item=_copy||_item,elementBehindCursor=getElementBehindPoint(_mirror,clientX,clientY),dropTarget=findDropTarget(elementBehindCursor,clientX,clientY),changed=null!==dropTarget&&dropTarget!==_lastDropTarget;(changed||null===dropTarget)&&(out(),_lastDropTarget=dropTarget,over());var parent=getParent(item);if(dropTarget===_source&&_copy&&!o.copySortSource)return void(parent&&parent.removeChild(item));var reference,immediate=getImmediateChild(dropTarget,elementBehindCursor);if(null!==immediate)reference=getReference(dropTarget,immediate,clientX,clientY);else{if(o.revertOnSpill!==!0||_copy)return void(_copy&&parent&&parent.removeChild(item));reference=_initialSibling,dropTarget=_source}(null===reference&&changed||reference!==item&&reference!==nextEl(item))&&(_currentSibling=reference,dropTarget.insertBefore(item,reference),drake.emit("shadow",item,dropTarget,_source))}}function spillOver(el){classes.rm(el,"gu-hide")}function spillOut(el){drake.dragging&&classes.add(el,"gu-hide")}function renderMirrorImage(){if(!_mirror){var rect=_item.getBoundingClientRect();_mirror=_item.cloneNode(!0),_mirror.style.width=getRectWidth(rect)+"px",_mirror.style.height=getRectHeight(rect)+"px",classes.rm(_mirror,"gu-transit"),classes.add(_mirror,"gu-mirror"),o.mirrorContainer.appendChild(_mirror),touchy(documentElement,"add","mousemove",drag),classes.add(o.mirrorContainer,"gu-unselectable"),drake.emit("cloned",_mirror,_item,"mirror")}}function removeMirrorImage(){_mirror&&(classes.rm(o.mirrorContainer,"gu-unselectable"),touchy(documentElement,"remove","mousemove",drag),getParent(_mirror).removeChild(_mirror),_mirror=null)}function getImmediateChild(dropTarget,target){for(var immediate=target;immediate!==dropTarget&&getParent(immediate)!==dropTarget;)immediate=getParent(immediate);return immediate===documentElement?null:immediate}function getReference(dropTarget,target,x,y){function outside(){var i,el,rect,len=dropTarget.children.length;for(i=0;i<len;i++){if(el=dropTarget.children[i],rect=el.getBoundingClientRect(),horizontal&&rect.left+rect.width/2>x)return el;if(!horizontal&&rect.top+rect.height/2>y)return el}return null}function inside(){var rect=target.getBoundingClientRect();return resolve(horizontal?x>rect.left+getRectWidth(rect)/2:y>rect.top+getRectHeight(rect)/2)}function resolve(after){return after?nextEl(target):target}var horizontal="horizontal"===o.direction,reference=target!==dropTarget?inside():outside();return reference}function isCopy(item,container){return"boolean"==typeof o.copy?o.copy:o.copy(item,container)}var len=arguments.length;1===len&&Array.isArray(initialContainers)===!1&&(options=initialContainers,initialContainers=[]);var _mirror,_source,_item,_offsetX,_offsetY,_moveX,_moveY,_initialSibling,_currentSibling,_copy,_renderTimer,_grabbed,_lastDropTarget=null,o=options||{};void 0===o.moves&&(o.moves=always),void 0===o.accepts&&(o.accepts=always),void 0===o.invalid&&(o.invalid=invalidTarget),void 0===o.containers&&(o.containers=initialContainers||[]),void 0===o.isContainer&&(o.isContainer=never),void 0===o.copy&&(o.copy=!1),void 0===o.copySortSource&&(o.copySortSource=!1),void 0===o.revertOnSpill&&(o.revertOnSpill=!1),void 0===o.removeOnSpill&&(o.removeOnSpill=!1),void 0===o.direction&&(o.direction="vertical"),void 0===o.ignoreInputTextSelection&&(o.ignoreInputTextSelection=!0),void 0===o.mirrorContainer&&(o.mirrorContainer=doc.body);var drake=emitter({containers:o.containers,start:manualStart,end:end,cancel:cancel,remove:remove,destroy:destroy,canMove:canMove,dragging:!1});return o.removeOnSpill===!0&&drake.on("over",spillOver).on("out",spillOut),events(),drake}function touchy(el,op,type,fn){var touch={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},pointers={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},microsoft={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};global.navigator.pointerEnabled?crossvent[op](el,pointers[type],fn):global.navigator.msPointerEnabled?crossvent[op](el,microsoft[type],fn):(crossvent[op](el,touch[type],fn),crossvent[op](el,type,fn))}function whichMouseButton(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var button=e.button;return void 0!==button?1&button?1:2&button?3:4&button?2:0:void 0}function getOffset(el){var rect=el.getBoundingClientRect();return{left:rect.left+getScroll("scrollLeft","pageXOffset"),top:rect.top+getScroll("scrollTop","pageYOffset")}}function getScroll(scrollProp,offsetProp){return"undefined"!=typeof global[offsetProp]?global[offsetProp]:documentElement.clientHeight?documentElement[scrollProp]:doc.body[scrollProp]}function getElementBehindPoint(point,x,y){var el,p=point||{},state=p.className;return p.className+=" gu-hide",el=doc.elementFromPoint(x,y),p.className=state,el}function never(){return!1}function always(){return!0}function getRectWidth(rect){return rect.width||rect.right-rect.left}function getRectHeight(rect){return rect.height||rect.bottom-rect.top}function getParent(el){return el.parentNode===doc?null:el.parentNode}function isInput(el){return"INPUT"===el.tagName||"TEXTAREA"===el.tagName||"SELECT"===el.tagName||isEditable(el)}function isEditable(el){return!!el&&("false"!==el.contentEditable&&("true"===el.contentEditable||isEditable(getParent(el))))}function nextEl(el){function manually(){var sibling=el;do sibling=sibling.nextSibling;while(sibling&&1!==sibling.nodeType);return sibling}return el.nextElementSibling||manually()}function getEventHost(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function getCoord(coord,e){var host=getEventHost(e),missMap={pageX:"clientX",pageY:"clientY"};return coord in missMap&&!(coord in host)&&missMap[coord]in host&&(coord=missMap[coord]),host[coord]}var emitter=require("contra/emitter"),crossvent=require("crossvent"),classes=require("./classes"),doc=document,documentElement=doc.documentElement;module.exports=dragula}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./classes":8,"contra/emitter":4,crossvent:5}],10:[function(require,module,exports){module.exports={EncodeType:"entity",isEmpty:function(val){return!val||(null===val||0==val.length||/^\s+$/.test(val))},arr1:["&nbsp;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&shy;","&reg;","&macr;","&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&Agrave;","&Aacute;","&Acirc;","&Atilde;","&Auml;","&Aring;","&AElig;","&Ccedil;","&Egrave;","&Eacute;","&Ecirc;","&Euml;","&Igrave;","&Iacute;","&Icirc;","&Iuml;","&ETH;","&Ntilde;","&Ograve;","&Oacute;","&Ocirc;","&Otilde;","&Ouml;","&times;","&Oslash;","&Ugrave;","&Uacute;","&Ucirc;","&Uuml;","&Yacute;","&THORN;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&quot;","&amp;","&lt;","&gt;","&OElig;","&oelig;","&Scaron;","&scaron;","&Yuml;","&circ;","&tilde;","&ensp;","&emsp;","&thinsp;","&zwnj;","&zwj;","&lrm;","&rlm;","&ndash;","&mdash;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&dagger;","&Dagger;","&permil;","&lsaquo;","&rsaquo;","&euro;","&fnof;","&Alpha;","&Beta;","&Gamma;","&Delta;","&Epsilon;","&Zeta;","&Eta;","&Theta;","&Iota;","&Kappa;","&Lambda;","&Mu;","&Nu;","&Xi;","&Omicron;","&Pi;","&Rho;","&Sigma;","&Tau;","&Upsilon;","&Phi;","&Chi;","&Psi;","&Omega;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigmaf;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&thetasym;","&upsih;","&piv;","&bull;","&hellip;","&prime;","&Prime;","&oline;","&frasl;","&weierp;","&image;","&real;","&trade;","&alefsym;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&crarr;","&lArr;","&uArr;","&rArr;","&dArr;","&hArr;","&forall;","&part;","&exist;","&empty;","&nabla;","&isin;","&notin;","&ni;","&prod;","&sum;","&minus;","&lowast;","&radic;","&prop;","&infin;","&ang;","&and;","&or;","&cap;","&cup;","&int;","&there4;","&sim;","&cong;","&asymp;","&ne;","&equiv;","&le;","&ge;","&sub;","&sup;","&nsub;","&sube;","&supe;","&oplus;","&otimes;","&perp;","&sdot;","&lceil;","&rceil;","&lfloor;","&rfloor;","&lang;","&rang;","&loz;","&spades;","&clubs;","&hearts;","&diams;"],arr2:["&#160;","&#161;","&#162;","&#163;","&#164;","&#165;","&#166;","&#167;","&#168;","&#169;","&#170;","&#171;","&#172;","&#173;","&#174;","&#175;","&#176;","&#177;","&#178;","&#179;","&#180;","&#181;","&#182;","&#183;","&#184;","&#185;","&#186;","&#187;","&#188;","&#189;","&#190;","&#191;","&#192;","&#193;","&#194;","&#195;","&#196;","&#197;","&#198;","&#199;","&#200;","&#201;","&#202;","&#203;","&#204;","&#205;","&#206;","&#207;","&#208;","&#209;","&#210;","&#211;","&#212;","&#213;","&#214;","&#215;","&#216;","&#217;","&#218;","&#219;","&#220;","&#221;","&#222;","&#223;","&#224;","&#225;","&#226;","&#227;","&#228;","&#229;","&#230;","&#231;","&#232;","&#233;","&#234;","&#235;","&#236;","&#237;","&#238;","&#239;","&#240;","&#241;","&#242;","&#243;","&#244;","&#245;","&#246;","&#247;","&#248;","&#249;","&#250;","&#251;","&#252;","&#253;","&#254;","&#255;","&#34;","&#38;","&#60;","&#62;","&#338;","&#339;","&#352;","&#353;","&#376;","&#710;","&#732;","&#8194;","&#8195;","&#8201;","&#8204;","&#8205;","&#8206;","&#8207;","&#8211;","&#8212;","&#8216;","&#8217;","&#8218;","&#8220;","&#8221;","&#8222;","&#8224;","&#8225;","&#8240;","&#8249;","&#8250;","&#8364;","&#402;","&#913;","&#914;","&#915;","&#916;","&#917;","&#918;","&#919;","&#920;","&#921;","&#922;","&#923;","&#924;","&#925;","&#926;","&#927;","&#928;","&#929;","&#931;","&#932;","&#933;","&#934;","&#935;","&#936;","&#937;","&#945;","&#946;","&#947;","&#948;","&#949;","&#950;","&#951;","&#952;","&#953;","&#954;","&#955;","&#956;","&#957;","&#958;","&#959;","&#960;","&#961;","&#962;","&#963;","&#964;","&#965;","&#966;","&#967;","&#968;","&#969;","&#977;","&#978;","&#982;","&#8226;","&#8230;","&#8242;","&#8243;","&#8254;","&#8260;","&#8472;","&#8465;","&#8476;","&#8482;","&#8501;","&#8592;","&#8593;","&#8594;","&#8595;","&#8596;","&#8629;","&#8656;","&#8657;","&#8658;","&#8659;","&#8660;","&#8704;","&#8706;","&#8707;","&#8709;","&#8711;","&#8712;","&#8713;","&#8715;","&#8719;","&#8721;","&#8722;","&#8727;","&#8730;","&#8733;","&#8734;","&#8736;","&#8743;","&#8744;","&#8745;","&#8746;","&#8747;","&#8756;","&#8764;","&#8773;","&#8776;","&#8800;","&#8801;","&#8804;","&#8805;","&#8834;","&#8835;","&#8836;","&#8838;","&#8839;","&#8853;","&#8855;","&#8869;","&#8901;","&#8968;","&#8969;","&#8970;","&#8971;","&#9001;","&#9002;","&#9674;","&#9824;","&#9827;","&#9829;","&#9830;"],HTML2Numerical:function(s){return this.swapArrayVals(s,this.arr1,this.arr2)},NumericalToHTML:function(s){return this.swapArrayVals(s,this.arr2,this.arr1)},numEncode:function(s){if(this.isEmpty(s))return"";for(var a=[],l=s.length,i=0;i<l;i++){var c=s.charAt(i);c<" "||c>"~"?(a.push("&#"),a.push(c.charCodeAt()),a.push(";")):a.push(c)}return a.join("")},htmlDecode:function(s){var c,m,arr,d=s;if(this.isEmpty(d))return"";if(d=this.HTML2Numerical(d),arr=d.match(/&#[0-9]{1,5};/g),null!=arr)for(var x=0;x<arr.length;x++)m=arr[x],c=m.substring(2,m.length-1),d=c>=-32768&&c<=65535?d.replace(m,String.fromCharCode(c)):d.replace(m,"");return d},htmlEncode:function(s,dbl){return this.isEmpty(s)?"":(dbl=dbl||!1,dbl&&(s="numerical"==this.EncodeType?s.replace(/&/g,"&#38;"):s.replace(/&/g,"&amp;")),s=this.XSSEncode(s,!1),"numerical"!=this.EncodeType&&dbl||(s=this.HTML2Numerical(s)),s=this.numEncode(s),dbl||(s=s.replace(/&#/g,"##AMPHASH##"),s="numerical"==this.EncodeType?s.replace(/&/g,"&#38;"):s.replace(/&/g,"&amp;"),s=s.replace(/##AMPHASH##/g,"&#")),s=s.replace(/&#\d*([^\d;]|$)/g,"$1"),dbl||(s=this.correctEncoding(s)),"entity"==this.EncodeType&&(s=this.NumericalToHTML(s)),s)},XSSEncode:function(s,en){return this.isEmpty(s)?"":(en=en||!0,en?(s=s.replace(/\'/g,"&#39;"),s=s.replace(/\"/g,"&quot;"),s=s.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;")):(s=s.replace(/\'/g,"&#39;"),s=s.replace(/\"/g,"&#34;"),s=s.replace(/</g,"&#60;"),s=s.replace(/>/g,"&#62;")),s)},hasEncoded:function(s){return!!/&#[0-9]{1,5};/g.test(s)||!!/&[A-Z]{2,6};/gi.test(s)},stripUnicode:function(s){return s.replace(/[^\x20-\x7E]/g,"")},correctEncoding:function(s){return s.replace(/(&amp;)(amp;)+/,"$1")},swapArrayVals:function(s,arr1,arr2){if(this.isEmpty(s))return"";var re;if(arr1&&arr2&&arr1.length==arr2.length)for(var x=0,i=arr1.length;x<i;x++)re=new RegExp(arr1[x],"g"),s=s.replace(re,arr2[x]);return s},inArray:function(item,arr){for(var i=0,x=arr.length;i<x;i++)if(arr[i]===item)return i;return-1}}},{}],11:[function(require,module,exports){var htmlencode=require("./encoder"),extend=require("util")._extend,Encoder=function(type){return type&&(this.EncodeType=type),this};extend(Encoder.prototype,htmlencode);var it=new Encoder;Object.defineProperty(module.exports,"EncodeType",{enumerable:!0,get:function(){return it.EncodeType},set:function(val){return it.EncodeType=val}}),["HTML2Numerical","NumericalToHTML","numEncode","htmlDecode","htmlEncode","XSSEncode","hasEncoded","stripUnicode","correctEncoding"].forEach(function(method){module.exports[method]=it[method].bind(it)}),module.exports.Encoder=Encoder},{"./encoder":10,util:17}],12:[function(require,module,exports){(function(process){"classList"in document.createElement("_")||!function(view){"use strict";if("Element"in view){var classListProp="classList",protoProp="prototype",elemCtrProto=view.Element[protoProp],objCtr=Object,strTrim=String[protoProp].trim||function(){return this.replace(/^\s+|\s+$/g,"")},arrIndexOf=Array[protoProp].indexOf||function(item){for(var i=0,len=this.length;i<len;i++)if(i in this&&this[i]===item)return i;return-1},DOMEx=function(type,message){this.name=type,this.code=DOMException[type],this.message=message},checkTokenAndGetIndex=function(classList,token){if(""===token)throw new DOMEx("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(token))throw new DOMEx("INVALID_CHARACTER_ERR","String contains an invalid character");return arrIndexOf.call(classList,token)},ClassList=function(elem){for(var trimmedClasses=strTrim.call(elem.getAttribute("class")||""),classes=trimmedClasses?trimmedClasses.split(/\s+/):[],i=0,len=classes.length;i<len;i++)this.push(classes[i]);this._updateClassName=function(){elem.setAttribute("class",this.toString())}},classListProto=ClassList[protoProp]=[],classListGetter=function(){return new ClassList(this)};if(DOMEx[protoProp]=Error[protoProp],classListProto.item=function(i){return this[i]||null},classListProto.contains=function(token){return token+="",checkTokenAndGetIndex(this,token)!==-1},classListProto.add=function(){var token,tokens=arguments,i=0,l=tokens.length,updated=!1;
do token=tokens[i]+"",checkTokenAndGetIndex(this,token)===-1&&(this.push(token),updated=!0);while(++i<l);updated&&this._updateClassName()},classListProto.remove=function(){var token,index,tokens=arguments,i=0,l=tokens.length,updated=!1;do for(token=tokens[i]+"",index=checkTokenAndGetIndex(this,token);index!==-1;)this.splice(index,1),updated=!0,index=checkTokenAndGetIndex(this,token);while(++i<l);updated&&this._updateClassName()},classListProto.toggle=function(token,force){token+="";var result=this.contains(token),method=result?force!==!0&&"remove":force!==!1&&"add";return method&&this[method](token),force===!0||force===!1?force:!result},classListProto.toString=function(){return this.join(" ")},objCtr.defineProperty){var classListPropDesc={get:classListGetter,enumerable:!0,configurable:!0};try{objCtr.defineProperty(elemCtrProto,classListProp,classListPropDesc)}catch(ex){ex.number===-2146823252&&(classListPropDesc.enumerable=!1,objCtr.defineProperty(elemCtrProto,classListProp,classListPropDesc))}}else objCtr[protoProp].__defineGetter__&&elemCtrProto.__defineGetter__(classListProp,classListGetter)}}(self),function(view){"use strict";if(view.URL=view.URL||view.webkitURL,view.Blob&&view.URL)try{return void new Blob}catch(e){}var BlobBuilder=view.BlobBuilder||view.WebKitBlobBuilder||view.MozBlobBuilder||function(view){var get_class=function(object){return Object.prototype.toString.call(object).match(/^\[object\s(.*)\]$/)[1]},FakeBlobBuilder=function(){this.data=[]},FakeBlob=function(data,type,encoding){this.data=data,this.size=data.length,this.type=type,this.encoding=encoding},FBB_proto=FakeBlobBuilder.prototype,FB_proto=FakeBlob.prototype,FileReaderSync=view.FileReaderSync,FileException=function(type){this.code=this[this.name=type]},file_ex_codes="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),file_ex_code=file_ex_codes.length,real_URL=view.URL||view.webkitURL||view,real_create_object_URL=real_URL.createObjectURL,real_revoke_object_URL=real_URL.revokeObjectURL,URL=real_URL,btoa=view.btoa,atob=view.atob,ArrayBuffer=view.ArrayBuffer,Uint8Array=view.Uint8Array,origin=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(FakeBlob.fake=FB_proto.fake=!0;file_ex_code--;)FileException.prototype[file_ex_codes[file_ex_code]]=file_ex_code+1;return real_URL.createObjectURL||(URL=view.URL=function(uri){var uri_origin,uri_info=document.createElementNS("http://www.w3.org/1999/xhtml","a");return uri_info.href=uri,"origin"in uri_info||("data:"===uri_info.protocol.toLowerCase()?uri_info.origin=null:(uri_origin=uri.match(origin),uri_info.origin=uri_origin&&uri_origin[1])),uri_info}),URL.createObjectURL=function(blob){var data_URI_header,type=blob.type;return null===type&&(type="application/octet-stream"),blob instanceof FakeBlob?(data_URI_header="data:"+type,"base64"===blob.encoding?data_URI_header+";base64,"+blob.data:"URI"===blob.encoding?data_URI_header+","+decodeURIComponent(blob.data):btoa?data_URI_header+";base64,"+btoa(blob.data):data_URI_header+","+encodeURIComponent(blob.data)):real_create_object_URL?real_create_object_URL.call(real_URL,blob):void 0},URL.revokeObjectURL=function(object_URL){"data:"!==object_URL.substring(0,5)&&real_revoke_object_URL&&real_revoke_object_URL.call(real_URL,object_URL)},FBB_proto.append=function(data){var bb=this.data;if(Uint8Array&&(data instanceof ArrayBuffer||data instanceof Uint8Array)){for(var str="",buf=new Uint8Array(data),i=0,buf_len=buf.length;i<buf_len;i++)str+=String.fromCharCode(buf[i]);bb.push(str)}else if("Blob"===get_class(data)||"File"===get_class(data)){if(!FileReaderSync)throw new FileException("NOT_READABLE_ERR");var fr=new FileReaderSync;bb.push(fr.readAsBinaryString(data))}else data instanceof FakeBlob?"base64"===data.encoding&&atob?bb.push(atob(data.data)):"URI"===data.encoding?bb.push(decodeURIComponent(data.data)):"raw"===data.encoding&&bb.push(data.data):("string"!=typeof data&&(data+=""),bb.push(unescape(encodeURIComponent(data))))},FBB_proto.getBlob=function(type){return arguments.length||(type=null),new FakeBlob(this.data.join(""),type,"raw")},FBB_proto.toString=function(){return"[object BlobBuilder]"},FB_proto.slice=function(start,end,type){var args=arguments.length;return args<3&&(type=null),new FakeBlob(this.data.slice(start,args>1?end:this.data.length),type,this.encoding)},FB_proto.toString=function(){return"[object Blob]"},FB_proto.close=function(){this.size=0,delete this.data},FakeBlobBuilder}(view);view.Blob=function(blobParts,options){var type=options?options.type||"":"",builder=new BlobBuilder;if(blobParts)for(var i=0,len=blobParts.length;i<len;i++)Uint8Array&&blobParts[i]instanceof Uint8Array?builder.append(blobParts[i].buffer):builder.append(blobParts[i]);var blob=builder.getBlob(type);return!blob.slice&&blob.webkitSlice&&(blob.slice=blob.webkitSlice),blob};var getPrototypeOf=Object.getPrototypeOf||function(object){return object.__proto__};view.Blob.prototype=getPrototypeOf(new view.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),function(root,factory){"use strict";var isElectron="object"==typeof module&&"undefined"!=typeof process&&process&&process.versions&&process.versions.electron;isElectron||"object"!=typeof module?"function"==typeof define&&define.amd?define(function(){return factory}):root.MediumEditor=factory:module.exports=factory}(this,function(){"use strict";function MediumEditor(elements,options){return this.init(elements,options)}return MediumEditor.extensions={},function(window){function copyInto(overwrite,dest){var prop,sources=Array.prototype.slice.call(arguments,2);dest=dest||{};for(var i=0;i<sources.length;i++){var source=sources[i];if(source)for(prop in source)source.hasOwnProperty(prop)&&"undefined"!=typeof source[prop]&&(overwrite||dest.hasOwnProperty(prop)===!1)&&(dest[prop]=source[prop])}return dest}var nodeContainsWorksWithTextNodes=!1;try{var testParent=document.createElement("div"),testText=document.createTextNode(" ");testParent.appendChild(testText),nodeContainsWorksWithTextNodes=testParent.contains(testText)}catch(exc){}var Util={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,isMac:window.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77,V:86},isMetaCtrlKey:function(event){return!!(Util.isMac&&event.metaKey||!Util.isMac&&event.ctrlKey)},isKey:function(event,keys){var keyCode=Util.getKeyCode(event);return!1===Array.isArray(keys)?keyCode===keys:-1!==keys.indexOf(keyCode)},getKeyCode:function(event){var keyCode=event.which;return null===keyCode&&(keyCode=null!==event.charCode?event.charCode:event.keyCode),keyCode},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function(){var args=[!0].concat(Array.prototype.slice.call(arguments));return copyInto.apply(this,args)},defaults:function(){var args=[!1].concat(Array.prototype.slice.call(arguments));return copyInto.apply(this,args)},createLink:function(document,textNodes,href,target){var anchor=document.createElement("a");return Util.moveTextRangeIntoElement(textNodes[0],textNodes[textNodes.length-1],anchor),anchor.setAttribute("href",href),target&&anchor.setAttribute("target",target),anchor},findOrCreateMatchingTextNodes:function(document,element,match){for(var treeWalker=document.createTreeWalker(element,NodeFilter.SHOW_ALL,null,!1),matchedNodes=[],currentTextIndex=0,startReached=!1,currentNode=null,newNode=null;null!==(currentNode=treeWalker.nextNode());)if(!(currentNode.nodeType>3))if(3===currentNode.nodeType){if(!startReached&&match.start<currentTextIndex+currentNode.nodeValue.length&&(startReached=!0,newNode=Util.splitStartNodeIfNeeded(currentNode,match.start,currentTextIndex)),startReached&&Util.splitEndNodeIfNeeded(currentNode,newNode,match.end,currentTextIndex),startReached&&currentTextIndex===match.end)break;if(startReached&&currentTextIndex>match.end+1)throw new Error("PerformLinking overshot the target!");startReached&&matchedNodes.push(newNode||currentNode),currentTextIndex+=currentNode.nodeValue.length,null!==newNode&&(currentTextIndex+=newNode.nodeValue.length,treeWalker.nextNode()),newNode=null}else"img"===currentNode.tagName.toLowerCase()&&(!startReached&&match.start<=currentTextIndex&&(startReached=!0),startReached&&matchedNodes.push(currentNode));return matchedNodes},splitStartNodeIfNeeded:function(currentNode,matchStartIndex,currentTextIndex){return matchStartIndex!==currentTextIndex?currentNode.splitText(matchStartIndex-currentTextIndex):null},splitEndNodeIfNeeded:function(currentNode,newNode,matchEndIndex,currentTextIndex){var textIndexOfEndOfFarthestNode,endSplitPoint;textIndexOfEndOfFarthestNode=currentTextIndex+currentNode.nodeValue.length+(newNode?newNode.nodeValue.length:0)-1,endSplitPoint=matchEndIndex-currentTextIndex-(newNode?currentNode.nodeValue.length:0),textIndexOfEndOfFarthestNode>=matchEndIndex&&currentTextIndex!==textIndexOfEndOfFarthestNode&&0!==endSplitPoint&&(newNode||currentNode).splitText(endSplitPoint)},splitByBlockElements:function(element){if(3!==element.nodeType&&1!==element.nodeType)return[];var toRet=[],blockElementQuery=MediumEditor.util.blockContainerElementNames.join(",");if(3===element.nodeType||0===element.querySelectorAll(blockElementQuery).length)return[element];for(var i=0;i<element.childNodes.length;i++){var child=element.childNodes[i];if(3===child.nodeType)toRet.push(child);else if(1===child.nodeType){var blockElements=child.querySelectorAll(blockElementQuery);0===blockElements.length?toRet.push(child):toRet=toRet.concat(MediumEditor.util.splitByBlockElements(child))}}return toRet},findAdjacentTextNodeWithContent:function(rootNode,targetNode,ownerDocument){var nextNode,pastTarget=!1,nodeIterator=ownerDocument.createNodeIterator(rootNode,NodeFilter.SHOW_TEXT,null,!1);for(nextNode=nodeIterator.nextNode();nextNode;){if(nextNode===targetNode)pastTarget=!0;else if(pastTarget&&3===nextNode.nodeType&&nextNode.nodeValue&&nextNode.nodeValue.trim().length>0)break;nextNode=nodeIterator.nextNode()}return nextNode},findPreviousSibling:function(node){if(!node||Util.isMediumEditorElement(node))return!1;for(var previousSibling=node.previousSibling;!previousSibling&&!Util.isMediumEditorElement(node.parentNode);)node=node.parentNode,previousSibling=node.previousSibling;return previousSibling},isDescendant:function(parent,child,checkEquality){if(!parent||!child)return!1;if(parent===child)return!!checkEquality;if(1!==parent.nodeType)return!1;if(nodeContainsWorksWithTextNodes||3!==child.nodeType)return parent.contains(child);for(var node=child.parentNode;null!==node;){if(node===parent)return!0;node=node.parentNode}return!1},isElement:function(obj){return!(!obj||1!==obj.nodeType)},throttle:function(func,wait){var context,args,result,THROTTLE_INTERVAL=50,timeout=null,previous=0,later=function(){previous=Date.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return wait||0===wait||(wait=THROTTLE_INTERVAL),function(){var now=Date.now(),remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||(timeout=setTimeout(later,remaining)),result}},traverseUp:function(current,testElementFunction){if(!current)return!1;do{if(1===current.nodeType){if(testElementFunction(current))return current;if(Util.isMediumEditorElement(current))return!1}current=current.parentNode}while(current);return!1},htmlEntities:function(str){return String(str).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(doc,html){var selection,range,el,fragment,node,lastNode,toReplace,res=!1,ecArgs=["insertHTML",!1,html];if(!MediumEditor.util.isEdge&&doc.queryCommandSupported("insertHTML"))try{return doc.execCommand.apply(doc,ecArgs)}catch(ignore){}if(selection=doc.getSelection(),selection.rangeCount){if(range=selection.getRangeAt(0),toReplace=range.commonAncestorContainer,Util.isMediumEditorElement(toReplace)&&!toReplace.firstChild)range.selectNode(toReplace.appendChild(doc.createTextNode("")));else if(3===toReplace.nodeType&&0===range.startOffset&&range.endOffset===toReplace.nodeValue.length||3!==toReplace.nodeType&&toReplace.innerHTML===range.toString()){for(;!Util.isMediumEditorElement(toReplace)&&toReplace.parentNode&&1===toReplace.parentNode.childNodes.length&&!Util.isMediumEditorElement(toReplace.parentNode);)toReplace=toReplace.parentNode;range.selectNode(toReplace)}for(range.deleteContents(),el=doc.createElement("div"),el.innerHTML=html,fragment=doc.createDocumentFragment();el.firstChild;)node=el.firstChild,lastNode=fragment.appendChild(node);range.insertNode(fragment),lastNode&&(range=range.cloneRange(),range.setStartAfter(lastNode),range.collapse(!0),MediumEditor.selection.selectRange(doc,range)),res=!0}return doc.execCommand.callListeners&&doc.execCommand.callListeners(ecArgs,res),res},execFormatBlock:function(doc,tagName){var childNodes,blockContainer=Util.getTopBlockContainer(MediumEditor.selection.getSelectionStart(doc));if("blockquote"===tagName){if(blockContainer&&(childNodes=Array.prototype.slice.call(blockContainer.childNodes),childNodes.some(function(childNode){return Util.isBlockContainer(childNode)})))return doc.execCommand("outdent",!1,null);if(Util.isIE)return doc.execCommand("indent",!1,tagName)}if(blockContainer&&tagName===blockContainer.nodeName.toLowerCase()&&(tagName="p"),Util.isIE&&(tagName="<"+tagName+">"),blockContainer&&"blockquote"===blockContainer.nodeName.toLowerCase()){if(Util.isIE&&"<p>"===tagName)return doc.execCommand("outdent",!1,tagName);if((Util.isFF||Util.isEdge)&&"p"===tagName)return childNodes=Array.prototype.slice.call(blockContainer.childNodes),childNodes.some(function(childNode){return!Util.isBlockContainer(childNode)})&&doc.execCommand("formatBlock",!1,tagName),doc.execCommand("outdent",!1,tagName)}return doc.execCommand("formatBlock",!1,tagName)},setTargetBlank:function(el,anchorUrl){var i,url=anchorUrl||!1;if("a"===el.nodeName.toLowerCase())el.target="_blank";else for(el=el.getElementsByTagName("a"),i=0;i<el.length;i+=1)!1!==url&&url!==el[i].attributes.href.value||(el[i].target="_blank")},removeTargetBlank:function(el,anchorUrl){var i;if("a"===el.nodeName.toLowerCase())el.removeAttribute("target");else for(el=el.getElementsByTagName("a"),i=0;i<el.length;i+=1)anchorUrl===el[i].attributes.href.value&&el[i].removeAttribute("target")},addClassToAnchors:function(el,buttonClass){var i,j,classes=buttonClass.split(" ");if("a"===el.nodeName.toLowerCase())for(j=0;j<classes.length;j+=1)el.classList.add(classes[j]);else for(el=el.getElementsByTagName("a"),i=0;i<el.length;i+=1)for(j=0;j<classes.length;j+=1)el[i].classList.add(classes[j])},isListItem:function(node){if(!node)return!1;if("li"===node.nodeName.toLowerCase())return!0;for(var parentNode=node.parentNode,tagName=parentNode.nodeName.toLowerCase();"li"===tagName||!Util.isBlockContainer(parentNode)&&"div"!==tagName;){if("li"===tagName)return!0;if(parentNode=parentNode.parentNode,!parentNode)return!1;tagName=parentNode.nodeName.toLowerCase()}return!1},cleanListDOM:function(ownerDocument,element){if("li"===element.nodeName.toLowerCase()){var list=element.parentElement;"p"===list.parentElement.nodeName.toLowerCase()&&(Util.unwrap(list.parentElement,ownerDocument),MediumEditor.selection.moveCursor(ownerDocument,element.firstChild,element.firstChild.textContent.length))}},splitOffDOMTree:function(rootNode,leafNode,splitLeft){for(var splitOnNode=leafNode,createdNode=null,splitRight=!splitLeft;splitOnNode!==rootNode;){var appendLast,currParent=splitOnNode.parentNode,newParent=currParent.cloneNode(!1),targetNode=splitRight?splitOnNode:currParent.firstChild;for(createdNode&&(splitRight?newParent.appendChild(createdNode):appendLast=createdNode),createdNode=newParent;targetNode;){var sibling=targetNode.nextSibling;targetNode===splitOnNode?(targetNode.hasChildNodes()?targetNode=targetNode.cloneNode(!1):targetNode.parentNode.removeChild(targetNode),targetNode.textContent&&createdNode.appendChild(targetNode),targetNode=splitRight?sibling:null):(targetNode.parentNode.removeChild(targetNode),(targetNode.hasChildNodes()||targetNode.textContent)&&createdNode.appendChild(targetNode),targetNode=sibling)}appendLast&&createdNode.appendChild(appendLast),splitOnNode=currParent}return createdNode},moveTextRangeIntoElement:function(startNode,endNode,newElement){if(!startNode||!endNode)return!1;var rootNode=Util.findCommonRoot(startNode,endNode);if(!rootNode)return!1;if(endNode===startNode){var temp=startNode.parentNode,sibling=startNode.nextSibling;return temp.removeChild(startNode),newElement.appendChild(startNode),sibling?temp.insertBefore(newElement,sibling):temp.appendChild(newElement),newElement.hasChildNodes()}for(var firstChild,lastChild,nextNode,rootChildren=[],i=0;i<rootNode.childNodes.length;i++)if(nextNode=rootNode.childNodes[i],firstChild){if(Util.isDescendant(nextNode,endNode,!0)){lastChild=nextNode;break}rootChildren.push(nextNode)}else Util.isDescendant(nextNode,startNode,!0)&&(firstChild=nextNode);var afterLast=lastChild.nextSibling,fragment=rootNode.ownerDocument.createDocumentFragment();return firstChild===startNode?(firstChild.parentNode.removeChild(firstChild),fragment.appendChild(firstChild)):fragment.appendChild(Util.splitOffDOMTree(firstChild,startNode)),rootChildren.forEach(function(element){element.parentNode.removeChild(element),fragment.appendChild(element)}),lastChild===endNode?(lastChild.parentNode.removeChild(lastChild),fragment.appendChild(lastChild)):fragment.appendChild(Util.splitOffDOMTree(lastChild,endNode,!0)),newElement.appendChild(fragment),lastChild.parentNode===rootNode?rootNode.insertBefore(newElement,lastChild):afterLast?rootNode.insertBefore(newElement,afterLast):rootNode.appendChild(newElement),newElement.hasChildNodes()},depthOfNode:function(inNode){for(var theDepth=0,node=inNode;null!==node.parentNode;)node=node.parentNode,theDepth++;return theDepth},findCommonRoot:function(inNode1,inNode2){for(var depth1=Util.depthOfNode(inNode1),depth2=Util.depthOfNode(inNode2),node1=inNode1,node2=inNode2;depth1!==depth2;)depth1>depth2?(node1=node1.parentNode,depth1-=1):(node2=node2.parentNode,depth2-=1);for(;node1!==node2;)node1=node1.parentNode,node2=node2.parentNode;return node1},isElementAtBeginningOfBlock:function(node){for(var textVal,sibling;!Util.isBlockContainer(node)&&!Util.isMediumEditorElement(node);){for(sibling=node;sibling=sibling.previousSibling;)if(textVal=3===sibling.nodeType?sibling.nodeValue:sibling.textContent,textVal.length>0)return!1;node=node.parentNode}return!0},isMediumEditorElement:function(element){return element&&element.getAttribute&&!!element.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(element){return Util.traverseUp(element,function(node){return Util.isMediumEditorElement(node)})},isBlockContainer:function(element){return element&&3!==element.nodeType&&Util.blockContainerElementNames.indexOf(element.nodeName.toLowerCase())!==-1},getClosestBlockContainer:function(node){return Util.traverseUp(node,function(node){return Util.isBlockContainer(node)||Util.isMediumEditorElement(node)})},getTopBlockContainer:function(element){var topBlock=!!Util.isBlockContainer(element)&&element;return Util.traverseUp(element,function(el){return Util.isBlockContainer(el)&&(topBlock=el),!(topBlock||!Util.isMediumEditorElement(el))&&(topBlock=el,!0)}),topBlock},getFirstSelectableLeafNode:function(element){for(;element&&element.firstChild;)element=element.firstChild;if(element=Util.traverseUp(element,function(el){return Util.emptyElementNames.indexOf(el.nodeName.toLowerCase())===-1}),"table"===element.nodeName.toLowerCase()){var firstCell=element.querySelector("th, td");firstCell&&(element=firstCell)}return element},getFirstTextNode:function(element){return Util.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"),Util._getFirstTextNode(element)},_getFirstTextNode:function(element){if(3===element.nodeType)return element;for(var i=0;i<element.childNodes.length;i++){var textNode=Util._getFirstTextNode(element.childNodes[i]);if(null!==textNode)return textNode}return null},ensureUrlHasProtocol:function(url){return url.indexOf("://")===-1?"http://"+url:url},warn:function(){void 0!==window.console&&"function"==typeof window.console.warn&&window.console.warn.apply(window.console,arguments)},deprecated:function(oldName,newName,version){var m=oldName+" is deprecated, please use "+newName+" instead.";version&&(m+=" Will be removed in "+version),Util.warn(m)},deprecatedMethod:function(oldName,newName,args,version){Util.deprecated(oldName,newName,version),"function"==typeof this[newName]&&this[newName].apply(this,args)},cleanupAttrs:function(el,attrs){attrs.forEach(function(attr){el.removeAttribute(attr)})},cleanupTags:function(el,tags){tags.indexOf(el.nodeName.toLowerCase())!==-1&&el.parentNode.removeChild(el)},unwrapTags:function(el,tags){tags.indexOf(el.nodeName.toLowerCase())!==-1&&MediumEditor.util.unwrap(el,document)},getClosestTag:function(el,tag){return Util.traverseUp(el,function(element){return element.nodeName.toLowerCase()===tag.toLowerCase()})},unwrap:function(el,doc){for(var fragment=doc.createDocumentFragment(),nodes=Array.prototype.slice.call(el.childNodes),i=0;i<nodes.length;i++)fragment.appendChild(nodes[i]);fragment.childNodes.length?el.parentNode.replaceChild(fragment,el):el.parentNode.removeChild(el)},guid:function(){function _s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return _s4()+_s4()+"-"+_s4()+"-"+_s4()+"-"+_s4()+"-"+_s4()+_s4()+_s4()}};MediumEditor.util=Util}(window),function(){var Extension=function(options){MediumEditor.util.extend(this,options)};Extension.extend=function(protoProps){var child,parent=this;child=protoProps&&protoProps.hasOwnProperty("constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)},MediumEditor.util.extend(child,parent);var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&MediumEditor.util.extend(child.prototype,protoProps),child},Extension.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,getInteractionElements:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(option){return this.base.options[option]}},["execAction","on","off","subscribe","trigger"].forEach(function(helper){Extension.prototype[helper]=function(){return this.base[helper].apply(this.base,arguments)}}),MediumEditor.Extension=Extension}(),function(){function filterOnlyParentElements(node){return MediumEditor.util.isBlockContainer(node)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var Selection={findMatchingSelectionParent:function(testElementFunction,contentWindow){var range,current,selection=contentWindow.getSelection();return 0!==selection.rangeCount&&(range=selection.getRangeAt(0),current=range.commonAncestorContainer,MediumEditor.util.traverseUp(current,testElementFunction))},getSelectionElement:function(contentWindow){return this.findMatchingSelectionParent(function(el){return MediumEditor.util.isMediumEditorElement(el)},contentWindow)},exportSelection:function(root,doc){if(!root)return null;var selectionState=null,selection=doc.getSelection();if(selection.rangeCount>0){var start,range=selection.getRangeAt(0),preSelectionRange=range.cloneRange();preSelectionRange.selectNodeContents(root),preSelectionRange.setEnd(range.startContainer,range.startOffset),start=preSelectionRange.toString().length,selectionState={start:start,end:start+range.toString().length},this.doesRangeStartWithImages(range,doc)&&(selectionState.startsWithImage=!0);var trailingImageCount=this.getTrailingImageCount(root,selectionState,range.endContainer,range.endOffset);if(trailingImageCount&&(selectionState.trailingImageCount=trailingImageCount),0!==start){var emptyBlocksIndex=this.getIndexRelativeToAdjacentEmptyBlocks(doc,root,range.startContainer,range.startOffset);emptyBlocksIndex!==-1&&(selectionState.emptyBlocksIndex=emptyBlocksIndex)}}return selectionState},importSelection:function(selectionState,root,doc,favorLaterSelectionAnchor){if(selectionState&&root){var range=doc.createRange();range.setStart(root,0),range.collapse(!0);var nextCharIndex,node=root,nodeStack=[],charIndex=0,foundStart=!1,foundEnd=!1,trailingImageCount=0,stop=!1,allowRangeToStartAtEndOfNode=!1,lastTextNode=null;for((favorLaterSelectionAnchor||selectionState.startsWithImage||"undefined"!=typeof selectionState.emptyBlocksIndex)&&(allowRangeToStartAtEndOfNode=!0);!stop&&node;)if(node.nodeType>3)node=nodeStack.pop();else{if(3!==node.nodeType||foundEnd){if(selectionState.trailingImageCount&&foundEnd&&("img"===node.nodeName.toLowerCase()&&trailingImageCount++,trailingImageCount===selectionState.trailingImageCount)){for(var endIndex=0;node.parentNode.childNodes[endIndex]!==node;)endIndex++;range.setEnd(node.parentNode,endIndex+1),stop=!0}if(!stop&&1===node.nodeType)for(var i=node.childNodes.length-1;i>=0;)nodeStack.push(node.childNodes[i]),i-=1}else nextCharIndex=charIndex+node.length,!foundStart&&selectionState.start>=charIndex&&selectionState.start<=nextCharIndex&&(allowRangeToStartAtEndOfNode||selectionState.start<nextCharIndex?(range.setStart(node,selectionState.start-charIndex),foundStart=!0):lastTextNode=node),foundStart&&selectionState.end>=charIndex&&selectionState.end<=nextCharIndex&&(selectionState.trailingImageCount?foundEnd=!0:(range.setEnd(node,selectionState.end-charIndex),stop=!0)),charIndex=nextCharIndex;stop||(node=nodeStack.pop())}!foundStart&&lastTextNode&&(range.setStart(lastTextNode,lastTextNode.length),range.setEnd(lastTextNode,lastTextNode.length)),"undefined"!=typeof selectionState.emptyBlocksIndex&&(range=this.importSelectionMoveCursorPastBlocks(doc,root,selectionState.emptyBlocksIndex,range)),favorLaterSelectionAnchor&&(range=this.importSelectionMoveCursorPastAnchor(selectionState,range)),this.selectRange(doc,range)}},importSelectionMoveCursorPastAnchor:function(selectionState,range){var nodeInsideAnchorTagFunction=function(node){return"a"===node.nodeName.toLowerCase()};if(selectionState.start===selectionState.end&&3===range.startContainer.nodeType&&range.startOffset===range.startContainer.nodeValue.length&&MediumEditor.util.traverseUp(range.startContainer,nodeInsideAnchorTagFunction)){for(var prevNode=range.startContainer,currentNode=range.startContainer.parentNode;null!==currentNode&&"a"!==currentNode.nodeName.toLowerCase();)currentNode.childNodes[currentNode.childNodes.length-1]!==prevNode?currentNode=null:(prevNode=currentNode,currentNode=currentNode.parentNode);if(null!==currentNode&&"a"===currentNode.nodeName.toLowerCase()){for(var currentNodeIndex=null,i=0;null===currentNodeIndex&&i<currentNode.parentNode.childNodes.length;i++)currentNode.parentNode.childNodes[i]===currentNode&&(currentNodeIndex=i);range.setStart(currentNode.parentNode,currentNodeIndex+1),range.collapse(!0)}}return range},importSelectionMoveCursorPastBlocks:function(doc,root,index,range){var startBlock,targetNode,treeWalker=doc.createTreeWalker(root,NodeFilter.SHOW_ELEMENT,filterOnlyParentElements,!1),startContainer=range.startContainer,currIndex=0;for(index=index||1,startBlock=3===startContainer.nodeType&&MediumEditor.util.isBlockContainer(startContainer.previousSibling)?startContainer.previousSibling:MediumEditor.util.getClosestBlockContainer(startContainer);treeWalker.nextNode();)if(targetNode){if(targetNode=treeWalker.currentNode,currIndex++,currIndex===index)break;if(targetNode.textContent.length>0)break}else startBlock===treeWalker.currentNode&&(targetNode=treeWalker.currentNode);return targetNode||(targetNode=startBlock),range.setStart(MediumEditor.util.getFirstSelectableLeafNode(targetNode),0),range},getIndexRelativeToAdjacentEmptyBlocks:function(doc,root,cursorContainer,cursorOffset){if(cursorContainer.textContent.length>0&&cursorOffset>0)return-1;var node=cursorContainer;if(3!==node.nodeType&&(node=cursorContainer.childNodes[cursorOffset]),node){if(!MediumEditor.util.isElementAtBeginningOfBlock(node))return-1;var previousSibling=MediumEditor.util.findPreviousSibling(node);if(!previousSibling)return-1;if(previousSibling.nodeValue)return-1}for(var closestBlock=MediumEditor.util.getClosestBlockContainer(cursorContainer),treeWalker=doc.createTreeWalker(root,NodeFilter.SHOW_ELEMENT,filterOnlyParentElements,!1),emptyBlocksCount=0;treeWalker.nextNode();){var blockIsEmpty=""===treeWalker.currentNode.textContent;if((blockIsEmpty||emptyBlocksCount>0)&&(emptyBlocksCount+=1),treeWalker.currentNode===closestBlock)return emptyBlocksCount;blockIsEmpty||(emptyBlocksCount=0)}return emptyBlocksCount},doesRangeStartWithImages:function(range,doc){if(0!==range.startOffset||1!==range.startContainer.nodeType)return!1;if("img"===range.startContainer.nodeName.toLowerCase())return!0;var img=range.startContainer.querySelector("img");if(!img)return!1;for(var treeWalker=doc.createTreeWalker(range.startContainer,NodeFilter.SHOW_ALL,null,!1);treeWalker.nextNode();){var next=treeWalker.currentNode;if(next===img)break;if(next.nodeValue)return!1}return!0},getTrailingImageCount:function(root,selectionState,endContainer,endOffset){if(0===endOffset||1!==endContainer.nodeType)return 0;if("img"!==endContainer.nodeName.toLowerCase()&&!endContainer.querySelector("img"))return 0;for(var lastNode=endContainer.childNodes[endOffset-1];lastNode.hasChildNodes();)lastNode=lastNode.lastChild;for(var nextCharIndex,node=root,nodeStack=[],charIndex=0,foundStart=!1,foundEnd=!1,stop=!1,trailingImages=0;!stop&&node;)if(node.nodeType>3)node=nodeStack.pop();else{if(3!==node.nodeType||foundEnd){if("img"===node.nodeName.toLowerCase()&&trailingImages++,node===lastNode)stop=!0;else if(1===node.nodeType)for(var i=node.childNodes.length-1;i>=0;)nodeStack.push(node.childNodes[i]),i-=1}else trailingImages=0,nextCharIndex=charIndex+node.length,!foundStart&&selectionState.start>=charIndex&&selectionState.start<=nextCharIndex&&(foundStart=!0),foundStart&&selectionState.end>=charIndex&&selectionState.end<=nextCharIndex&&(foundEnd=!0),charIndex=nextCharIndex;stop||(node=nodeStack.pop())}return trailingImages},selectionContainsContent:function(doc){var sel=doc.getSelection();if(!sel||sel.isCollapsed||!sel.rangeCount)return!1;if(""!==sel.toString().trim())return!0;var selectionNode=this.getSelectedParentElement(sel.getRangeAt(0));return!(!selectionNode||!("img"===selectionNode.nodeName.toLowerCase()||1===selectionNode.nodeType&&selectionNode.querySelector("img")))},selectionInContentEditableFalse:function(contentWindow){var sawtrue,sawfalse=this.findMatchingSelectionParent(function(el){var ce=el&&el.getAttribute("contenteditable");return"true"===ce&&(sawtrue=!0),"#text"!==el.nodeName&&"false"===ce},contentWindow);return!sawtrue&&sawfalse},getSelectionHtml:function(doc){var i,len,container,html="",sel=doc.getSelection();if(sel.rangeCount){for(container=doc.createElement("div"),i=0,len=sel.rangeCount;i<len;i+=1)container.appendChild(sel.getRangeAt(i).cloneContents());html=container.innerHTML}return html},getCaretOffsets:function(element,range){
var preCaretRange,postCaretRange;return range||(range=window.getSelection().getRangeAt(0)),preCaretRange=range.cloneRange(),postCaretRange=range.cloneRange(),preCaretRange.selectNodeContents(element),preCaretRange.setEnd(range.endContainer,range.endOffset),postCaretRange.selectNodeContents(element),postCaretRange.setStart(range.endContainer,range.endOffset),{left:preCaretRange.toString().length,right:postCaretRange.toString().length}},rangeSelectsSingleNode:function(range){var startNode=range.startContainer;return startNode===range.endContainer&&startNode.hasChildNodes()&&range.endOffset===range.startOffset+1},getSelectedParentElement:function(range){return range?this.rangeSelectsSingleNode(range)&&3!==range.startContainer.childNodes[range.startOffset].nodeType?range.startContainer.childNodes[range.startOffset]:3===range.startContainer.nodeType?range.startContainer.parentNode:range.startContainer:null},getSelectedElements:function(doc){var range,toRet,currNode,selection=doc.getSelection();if(!selection.rangeCount||selection.isCollapsed||!selection.getRangeAt(0).commonAncestorContainer)return[];if(range=selection.getRangeAt(0),3===range.commonAncestorContainer.nodeType){for(toRet=[],currNode=range.commonAncestorContainer;currNode.parentNode&&1===currNode.parentNode.childNodes.length;)toRet.push(currNode.parentNode),currNode=currNode.parentNode;return toRet}return[].filter.call(range.commonAncestorContainer.getElementsByTagName("*"),function(el){return"function"!=typeof selection.containsNode||selection.containsNode(el,!0)})},selectNode:function(node,doc){var range=doc.createRange();range.selectNodeContents(node),this.selectRange(doc,range)},select:function(doc,startNode,startOffset,endNode,endOffset){var range=doc.createRange();return range.setStart(startNode,startOffset),endNode?range.setEnd(endNode,endOffset):range.collapse(!0),this.selectRange(doc,range),range},clearSelection:function(doc,moveCursorToStart){moveCursorToStart?doc.getSelection().collapseToStart():doc.getSelection().collapseToEnd()},moveCursor:function(doc,node,offset){this.select(doc,node,offset)},getSelectionRange:function(ownerDocument){var selection=ownerDocument.getSelection();return 0===selection.rangeCount?null:selection.getRangeAt(0)},selectRange:function(ownerDocument,range){var selection=ownerDocument.getSelection();selection.removeAllRanges(),selection.addRange(range)},getSelectionStart:function(ownerDocument){var node=ownerDocument.getSelection().anchorNode,startNode=node&&3===node.nodeType?node.parentNode:node;return startNode}};MediumEditor.selection=Selection}(),function(){function isElementDescendantOfExtension(extensions,element){return extensions.some(function(extension){if("function"!=typeof extension.getInteractionElements)return!1;var extensionElements=extension.getInteractionElements();return!!extensionElements&&(Array.isArray(extensionElements)||(extensionElements=[extensionElements]),extensionElements.some(function(el){return MediumEditor.util.isDescendant(el,element,!0)}))})}var Events=function(instance){this.base=instance,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}};Events.prototype={InputEventOnContenteditableSupported:!MediumEditor.util.isIE&&!MediumEditor.util.isEdge,attachDOMEvent:function(targets,event,listener,useCapture){var win=this.base.options.contentWindow,doc=this.base.options.ownerDocument;targets=MediumEditor.util.isElement(targets)||[win,doc].indexOf(targets)>-1?[targets]:targets,Array.prototype.forEach.call(targets,function(target){target.addEventListener(event,listener,useCapture),this.events.push([target,event,listener,useCapture])}.bind(this))},detachDOMEvent:function(targets,event,listener,useCapture){var index,e,win=this.base.options.contentWindow,doc=this.base.options.ownerDocument;null!==targets&&(targets=MediumEditor.util.isElement(targets)||[win,doc].indexOf(targets)>-1?[targets]:targets,Array.prototype.forEach.call(targets,function(target){index=this.indexOfListener(target,event,listener,useCapture),index!==-1&&(e=this.events.splice(index,1)[0],e[0].removeEventListener(e[1],e[2],e[3]))}.bind(this)))},indexOfListener:function(target,event,listener,useCapture){var i,n,item;for(i=0,n=this.events.length;i<n;i+=1)if(item=this.events[i],item[0]===target&&item[1]===event&&item[2]===listener&&item[3]===useCapture)return i;return-1},detachAllDOMEvents:function(){for(var e=this.events.pop();e;)e[0].removeEventListener(e[1],e[2],e[3]),e=this.events.pop()},detachAllEventsFromElement:function(element){for(var filtered=this.events.filter(function(e){return e&&e[0].getAttribute&&e[0].getAttribute("medium-editor-index")===element.getAttribute("medium-editor-index")}),i=0,len=filtered.length;i<len;i++){var e=filtered[i];this.detachDOMEvent(e[0],e[1],e[2],e[3])}},attachAllEventsToElement:function(element){this.listeners.editableInput&&(this.contentCache[element.getAttribute("medium-editor-index")]=element.innerHTML),this.eventsCache&&this.eventsCache.forEach(function(e){this.attachDOMEvent(element,e.name,e.handler.bind(this))},this)},enableCustomEvent:function(event){void 0!==this.disabledEvents[event]&&delete this.disabledEvents[event]},disableCustomEvent:function(event){this.disabledEvents[event]=!0},attachCustomEvent:function(event,listener){this.setupListener(event),this.customEvents[event]||(this.customEvents[event]=[]),this.customEvents[event].push(listener)},detachCustomEvent:function(event,listener){var index=this.indexOfCustomListener(event,listener);index!==-1&&this.customEvents[event].splice(index,1)},indexOfCustomListener:function(event,listener){return this.customEvents[event]&&this.customEvents[event].length?this.customEvents[event].indexOf(listener):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(name,data,editable){this.customEvents[name]&&!this.disabledEvents[name]&&this.customEvents[name].forEach(function(listener){listener(data,editable)})},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach(function(element){element.removeAttribute("data-medium-focused")})},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=function(execInfo){this.handleDocumentExecCommand(execInfo)}.bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var doc=this.options.ownerDocument;if(this.execCommandListener&&doc.execCommand.listeners){var index=doc.execCommand.listeners.indexOf(this.execCommandListener);index!==-1&&doc.execCommand.listeners.splice(index,1),doc.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var doc=this.options.ownerDocument;if(!doc.execCommand.listeners){var callListeners=function(args,result){doc.execCommand.listeners&&doc.execCommand.listeners.forEach(function(listener){listener({command:args[0],value:args[2],args:args,result:result})})},wrapper=function(){var result=doc.execCommand.orig.apply(this,arguments);if(!doc.execCommand.listeners)return result;var args=Array.prototype.slice.call(arguments);return callListeners(args,result),result};wrapper.orig=doc.execCommand,wrapper.listeners=[],wrapper.callListeners=callListeners,doc.execCommand=wrapper}},unwrapExecCommand:function(){var doc=this.options.ownerDocument;doc.execCommand.orig&&(doc.execCommand=doc.execCommand.orig)},setupListener:function(name){if(!this.listeners[name]){switch(name){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":this.setupListener("externalInteraction");break;case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache={},this.base.elements.forEach(function(element){this.contentCache[element.getAttribute("medium-editor-index")]=element.innerHTML},this),this.InputEventOnContenteditableSupported&&this.attachToEachElement("input",this.handleInput),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownSpace":this.setupListener("editableKeydown");break;case"editableKeydownEnter":this.setupListener("editableKeydown");break;case"editableKeydownTab":this.setupListener("editableKeydown");break;case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[name]=!0}},attachToEachElement:function(name,handler){this.eventsCache||(this.eventsCache=[]),this.base.elements.forEach(function(element){this.attachDOMEvent(element,name,handler.bind(this))},this),this.eventsCache.push({name:name,handler:handler})},cleanupElement:function(element){var index=element.getAttribute("medium-editor-index");index&&(this.detachAllEventsFromElement(element),this.contentCache&&delete this.contentCache[index])},focusElement:function(element){element.focus(),this.updateFocus(element,{target:element,type:"focus"})},updateFocus:function(target,eventObj){var toFocus,hadFocus=this.base.getFocusedElement();hadFocus&&"click"===eventObj.type&&this.lastMousedownTarget&&(MediumEditor.util.isDescendant(hadFocus,this.lastMousedownTarget,!0)||isElementDescendantOfExtension(this.base.extensions,this.lastMousedownTarget))&&(toFocus=hadFocus),toFocus||this.base.elements.some(function(element){return!toFocus&&MediumEditor.util.isDescendant(element,target,!0)&&(toFocus=element),!!toFocus},this);var externalEvent=!MediumEditor.util.isDescendant(hadFocus,target,!0)&&!isElementDescendantOfExtension(this.base.extensions,target);toFocus!==hadFocus&&(hadFocus&&externalEvent&&(hadFocus.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",eventObj,hadFocus)),toFocus&&(toFocus.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",eventObj,toFocus))),externalEvent&&this.triggerCustomEvent("externalInteraction",eventObj)},updateInput:function(target,eventObj){if(this.contentCache){var index=target.getAttribute("medium-editor-index"),html=target.innerHTML;html!==this.contentCache[index]&&this.triggerCustomEvent("editableInput",eventObj,target),this.contentCache[index]=html}},handleDocumentSelectionChange:function(event){if(event.currentTarget&&event.currentTarget.activeElement){var currentTarget,activeElement=event.currentTarget.activeElement;this.base.elements.some(function(element){return!!MediumEditor.util.isDescendant(element,activeElement,!0)&&(currentTarget=element,!0)},this),currentTarget&&this.updateInput(currentTarget,{target:activeElement,currentTarget:currentTarget})}},handleDocumentExecCommand:function(){var target=this.base.getFocusedElement();target&&this.updateInput(target,{target:target,currentTarget:target})},handleBodyClick:function(event){this.updateFocus(event.target,event)},handleBodyFocus:function(event){this.updateFocus(event.target,event)},handleBodyMousedown:function(event){this.lastMousedownTarget=event.target},handleInput:function(event){this.updateInput(event.currentTarget,event)},handleClick:function(event){this.triggerCustomEvent("editableClick",event,event.currentTarget)},handleBlur:function(event){this.triggerCustomEvent("editableBlur",event,event.currentTarget)},handleKeypress:function(event){if(this.triggerCustomEvent("editableKeypress",event,event.currentTarget),this.keypressUpdateInput){var eventObj={target:event.target,currentTarget:event.currentTarget};setTimeout(function(){this.updateInput(eventObj.currentTarget,eventObj)}.bind(this),0)}},handleKeyup:function(event){this.triggerCustomEvent("editableKeyup",event,event.currentTarget)},handleMouseover:function(event){this.triggerCustomEvent("editableMouseover",event,event.currentTarget)},handleDragging:function(event){this.triggerCustomEvent("editableDrag",event,event.currentTarget)},handleDrop:function(event){this.triggerCustomEvent("editableDrop",event,event.currentTarget)},handlePaste:function(event){this.triggerCustomEvent("editablePaste",event,event.currentTarget)},handleKeydown:function(event){return this.triggerCustomEvent("editableKeydown",event,event.currentTarget),MediumEditor.util.isKey(event,MediumEditor.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",event,event.currentTarget):MediumEditor.util.isKey(event,MediumEditor.util.keyCode.ENTER)||event.ctrlKey&&MediumEditor.util.isKey(event,MediumEditor.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",event,event.currentTarget):MediumEditor.util.isKey(event,MediumEditor.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",event,event.currentTarget):MediumEditor.util.isKey(event,[MediumEditor.util.keyCode.DELETE,MediumEditor.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",event,event.currentTarget):void 0}},MediumEditor.Events=Events}(),function(){var Button=MediumEditor.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(options){Button.isBuiltInButton(options)?MediumEditor.Extension.call(this,this.defaults[options]):MediumEditor.Extension.call(this,options)},init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames},createButton:function(){var button=this.document.createElement("button"),content=this.contentDefault,ariaLabel=this.getAria(),buttonLabels=this.getEditorOption("buttonLabels");return button.classList.add("medium-editor-action"),button.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach(function(className){button.classList.add(className)}),button.setAttribute("data-action",this.getAction()),ariaLabel&&(button.setAttribute("title",ariaLabel),button.setAttribute("aria-label",ariaLabel)),this.attrs&&Object.keys(this.attrs).forEach(function(attr){button.setAttribute(attr,this.attrs[attr])},this),"fontawesome"===buttonLabels&&this.contentFA&&(content=this.contentFA),button.innerHTML=content,button},handleClick:function(event){event.preventDefault(),event.stopPropagation();var action=this.getAction();action&&this.execAction(action)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var queryState=null;return this.useQueryState&&(queryState=this.base.queryCommandState(this.getAction())),queryState},isAlreadyApplied:function(node){var styleVals,computedStyle,isMatch=!1,tagNames=this.getTagNames();return this.knownState===!1||this.knownState===!0?this.knownState:(tagNames&&tagNames.length>0&&(isMatch=tagNames.indexOf(node.nodeName.toLowerCase())!==-1),!isMatch&&this.style&&(styleVals=this.style.value.split("|"),computedStyle=this.window.getComputedStyle(node,null).getPropertyValue(this.style.prop),styleVals.forEach(function(val){this.knownState||(isMatch=computedStyle.indexOf(val)!==-1,(isMatch||"text-decoration"!==this.style.prop)&&(this.knownState=isMatch))},this)),isMatch)}});Button.isBuiltInButton=function(name){return"string"==typeof name&&MediumEditor.extensions.button.prototype.defaults.hasOwnProperty(name)},MediumEditor.extensions.button=Button}(),function(){MediumEditor.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}}}(),function(){var FormExtension=MediumEditor.extensions.button.extend({init:function(){MediumEditor.extensions.button.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:!0,getForm:function(){},isDisplayed:function(){return!!this.hasForm&&this.getForm().classList.contains(this.activeClass)},showForm:function(){this.hasForm&&this.getForm().classList.add(this.activeClass)},hideForm:function(){this.hasForm&&this.getForm().classList.remove(this.activeClass)},showToolbarDefaultActions:function(){var toolbar=this.base.getExtensionByName("toolbar");toolbar&&toolbar.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var toolbar=this.base.getExtensionByName("toolbar");toolbar&&toolbar.hideToolbarDefaultActions()},setToolbarPosition:function(){var toolbar=this.base.getExtensionByName("toolbar");toolbar&&toolbar.setToolbarPosition()}});MediumEditor.extensions.form=FormExtension}(),function(){var AnchorForm=MediumEditor.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(event){event.preventDefault(),event.stopPropagation();var range=MediumEditor.selection.getSelectionRange(this.document);return"a"===range.startContainer.nodeName.toLowerCase()||"a"===range.endContainer.nodeName.toLowerCase()||MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(range),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(event){MediumEditor.util.isKey(event,MediumEditor.util.keyCode.K)&&MediumEditor.util.isMetaCtrlKey(event)&&!event.shiftKey&&this.handleClick(event)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var template=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return template.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),template.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&template.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target">',"<label>",this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&template.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),template.join("")},isDisplayed:function(){return MediumEditor.extensions.form.prototype.isDisplayed.apply(this)},hideForm:function(){MediumEditor.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(opts){var input=this.getInput(),targetCheckbox=this.getAnchorTargetCheckbox(),buttonCheckbox=this.getAnchorButtonCheckbox();if(opts=opts||{value:""},"string"==typeof opts&&(opts={value:opts}),this.base.saveSelection(),this.hideToolbarDefaultActions(),MediumEditor.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),input.value=opts.value,input.focus(),targetCheckbox&&(targetCheckbox.checked="_blank"===opts.target),buttonCheckbox){var classList=opts.buttonClass?opts.buttonClass.split(" "):[];buttonCheckbox.checked=classList.indexOf(this.customClassOption)!==-1}},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},getFormOpts:function(){var targetCheckbox=this.getAnchorTargetCheckbox(),buttonCheckbox=this.getAnchorButtonCheckbox(),opts={value:this.getInput().value.trim()};return this.linkValidation&&(opts.value=this.checkLinkFormat(opts.value)),opts.target="_self",targetCheckbox&&targetCheckbox.checked&&(opts.target="_blank"),buttonCheckbox&&buttonCheckbox.checked&&(opts.buttonClass=this.customClassOption),opts},doFormSave:function(){var opts=this.getFormOpts();this.completeFormSave(opts)},completeFormSave:function(opts){this.base.restoreSelection(),this.execAction(this.action,opts),this.base.checkSelection()},ensureEncodedUri:function(str){return str===decodeURI(str)?encodeURI(str):str},ensureEncodedUriComponent:function(str){return str===decodeURIComponent(str)?encodeURIComponent(str):str},ensureEncodedParam:function(param){var split=param.split("="),key=split[0],val=split[1];return key+(void 0===val?"":"="+this.ensureEncodedUriComponent(val))},ensureEncodedQuery:function(queryString){return queryString.split("&").map(this.ensureEncodedParam.bind(this)).join("&")},checkLinkFormat:function(value){var urlSchemeRegex=/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i,telRegex=/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/,split=value.split("?"),path=split[0],query=split[1];return telRegex.test(value)?"tel:"+value:(urlSchemeRegex.test(value)?"":"http://")+this.ensureEncodedUri(path)+(void 0===query?"":"?"+this.ensureEncodedQuery(query))},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(form){var close=form.querySelector(".medium-editor-toolbar-close"),save=form.querySelector(".medium-editor-toolbar-save"),input=form.querySelector(".medium-editor-toolbar-input");this.on(form,"click",this.handleFormClick.bind(this)),this.on(input,"keyup",this.handleTextboxKeyup.bind(this)),this.on(close,"click",this.handleCloseClick.bind(this)),this.on(save,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var doc=this.document,form=doc.createElement("div");return form.className="medium-editor-toolbar-form",form.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),form.innerHTML=this.getTemplate(),this.attachFormEvents(form),form},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(event){return event.keyCode===MediumEditor.util.keyCode.ENTER?(event.preventDefault(),void this.doFormSave()):void(event.keyCode===MediumEditor.util.keyCode.ESCAPE&&(event.preventDefault(),this.doFormCancel()))},handleFormClick:function(event){event.stopPropagation()},handleSaveClick:function(event){event.preventDefault(),this.doFormSave()},handleCloseClick:function(event){event.preventDefault(),this.doFormCancel()}});MediumEditor.extensions.anchor=AnchorForm}(),function(){var AnchorPreview=MediumEditor.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:!1,showOnEmptyLinks:!0,init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getInteractionElements:function(){return this.getPreviewElement()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var el=this.document.createElement("div");return el.id="medium-editor-anchor-preview-"+this.getEditorId(),el.className="medium-editor-anchor-preview",el.innerHTML=this.getTemplate(),this.on(el,"click",this.handleClick.bind(this)),el},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview&&this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(anchorEl){return!(!this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&!anchorEl.getAttribute("data-disable-preview"))||(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=anchorEl.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=anchorEl.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=anchorEl,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(activeAnchor){activeAnchor=activeAnchor||this.activeAnchor;var halfOffsetWidth,defaultLeft,middleBoundary,elementsContainerBoundary,top,containerWidth=this.window.innerWidth,buttonHeight=this.anchorPreview.offsetHeight,boundary=activeAnchor.getBoundingClientRect(),diffLeft=this.diffLeft,diffTop=this.diffTop,elementsContainer=this.getEditorOption("elementsContainer"),elementsContainerAbsolute=["absolute","fixed"].indexOf(window.getComputedStyle(elementsContainer).getPropertyValue("position"))>-1,relativeBoundary={};halfOffsetWidth=this.anchorPreview.offsetWidth/2;var toolbarExtension=this.base.getExtensionByName("toolbar");toolbarExtension&&(diffLeft=toolbarExtension.diffLeft,diffTop=toolbarExtension.diffTop),defaultLeft=diffLeft-halfOffsetWidth,elementsContainerAbsolute?(elementsContainerBoundary=elementsContainer.getBoundingClientRect(),["top","left"].forEach(function(key){relativeBoundary[key]=boundary[key]-elementsContainerBoundary[key]}),relativeBoundary.width=boundary.width,relativeBoundary.height=boundary.height,boundary=relativeBoundary,containerWidth=elementsContainerBoundary.width,top=elementsContainer.scrollTop):top=this.window.pageYOffset,middleBoundary=boundary.left+boundary.width/2,top+=buttonHeight+boundary.top+boundary.height-diffTop-this.anchorPreview.offsetHeight,this.anchorPreview.style.top=Math.round(top)+"px",this.anchorPreview.style.right="initial",middleBoundary<halfOffsetWidth?(this.anchorPreview.style.left=defaultLeft+halfOffsetWidth+"px",this.anchorPreview.style.right="initial"):containerWidth-middleBoundary<halfOffsetWidth?(this.anchorPreview.style.left="auto",this.anchorPreview.style.right=0):(this.anchorPreview.style.left=defaultLeft+middleBoundary+"px",this.anchorPreview.style.right="initial")},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this)),
this.subscribe("positionedToolbar",this.handlePositionedToolbar.bind(this))},handlePositionedToolbar:function(){this.showWhenToolbarIsVisible||this.hidePreview()},handleClick:function(event){var anchorExtension=this.base.getExtensionByName("anchor"),activeAnchor=this.activeAnchor;anchorExtension&&activeAnchor&&(event.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay(function(){if(activeAnchor){var opts={value:activeAnchor.attributes.href.value,target:activeAnchor.getAttribute("target"),buttonClass:activeAnchor.getAttribute("class")};anchorExtension.showForm(opts),activeAnchor=null}}.bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(event){var target=MediumEditor.util.getClosestTag(event.target,"a");if(!1!==target){if(!this.showOnEmptyLinks&&(!/href=["']\S+["']/.test(target.outerHTML)||/href=["']#\S+["']/.test(target.outerHTML)))return!0;var toolbar=this.base.getExtensionByName("toolbar");if(!this.showWhenToolbarIsVisible&&toolbar&&toolbar.isDisplayed&&toolbar.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==target&&this.detachPreviewHandlers(),this.anchorToPreview=target,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay(function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}.bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(event){event.relatedTarget&&/anchor-preview/.test(event.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;var durr=(new Date).getTime()-this.lastOver;durr>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}});MediumEditor.extensions.anchorPreview=AnchorPreview}(),function(){function nodeIsNotInsideAnchorTag(node){return!MediumEditor.util.getClosestTag(node,"a")}var WHITESPACE_CHARS,KNOWN_TLDS_FRAGMENT,LINK_REGEXP_TEXT,KNOWN_TLDS_REGEXP,LINK_REGEXP;WHITESPACE_CHARS=[" ","\t","\n","\r"," "," "," "," "," ","\u2028","\u2029"],KNOWN_TLDS_FRAGMENT="com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw",LINK_REGEXP_TEXT="(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.]("+KNOWN_TLDS_FRAGMENT+")\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?«»“”‘’])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.("+KNOWN_TLDS_FRAGMENT+"))",KNOWN_TLDS_REGEXP=new RegExp("^("+KNOWN_TLDS_FRAGMENT+")$","i"),LINK_REGEXP=new RegExp(LINK_REGEXP_TEXT,"gi");var AutoLink=MediumEditor.Extension.extend({init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},isLastInstance:function(){for(var activeInstances=0,i=0;i<this.window._mediumEditors.length;i++){var editor=this.window._mediumEditors[i];null!==editor&&void 0!==editor.getExtensionByName("autoLink")&&activeInstances++}return 1===activeInstances},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(blurEvent,editable){this.performLinking(editable)},onKeypress:function(keyPressEvent){this.disableEventHandling||MediumEditor.util.isKey(keyPressEvent,[MediumEditor.util.keyCode.SPACE,MediumEditor.util.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout(function(){try{var sel=this.base.exportSelection();this.performLinking(keyPressEvent.target)&&this.base.importSelection(sel,!0)}catch(e){window.console&&window.console.error("Failed to perform linking",e),this.disableEventHandling=!0}}.bind(this),0))},performLinking:function(contenteditable){var blockElements=MediumEditor.util.splitByBlockElements(contenteditable),documentModified=!1;0===blockElements.length&&(blockElements=[contenteditable]);for(var i=0;i<blockElements.length;i++)documentModified=this.removeObsoleteAutoLinkSpans(blockElements[i])||documentModified,documentModified=this.performLinkingWithinElement(blockElements[i])||documentModified;return this.base.events.updateInput(contenteditable,{target:contenteditable,currentTarget:contenteditable}),documentModified},removeObsoleteAutoLinkSpans:function(element){if(!element||3===element.nodeType)return!1;for(var spans=element.querySelectorAll('span[data-auto-link="true"]'),documentModified=!1,i=0;i<spans.length;i++){var textContent=spans[i].textContent;if(textContent.indexOf("://")===-1&&(textContent=MediumEditor.util.ensureUrlHasProtocol(textContent)),spans[i].getAttribute("data-href")!==textContent&&nodeIsNotInsideAnchorTag(spans[i])){documentModified=!0;var trimmedTextContent=textContent.replace(/\s+$/,"");if(spans[i].getAttribute("data-href")===trimmedTextContent){var charactersTrimmed=textContent.length-trimmedTextContent.length,subtree=MediumEditor.util.splitOffDOMTree(spans[i],this.splitTextBeforeEnd(spans[i],charactersTrimmed));spans[i].parentNode.insertBefore(subtree,spans[i].nextSibling)}else MediumEditor.util.unwrap(spans[i],this.document)}}return documentModified},splitTextBeforeEnd:function(element,characterCount){for(var treeWalker=this.document.createTreeWalker(element,NodeFilter.SHOW_TEXT,null,!1),lastChildNotExhausted=!0;lastChildNotExhausted;)lastChildNotExhausted=null!==treeWalker.lastChild();for(var currentNode,currentNodeValue,previousNode;characterCount>0&&null!==previousNode;)currentNode=treeWalker.currentNode,currentNodeValue=currentNode.nodeValue,currentNodeValue.length>characterCount?(previousNode=currentNode.splitText(currentNodeValue.length-characterCount),characterCount=0):(previousNode=treeWalker.previousNode(),characterCount-=currentNodeValue.length);return previousNode},performLinkingWithinElement:function(element){for(var matches=this.findLinkableText(element),linkCreated=!1,matchIndex=0;matchIndex<matches.length;matchIndex++){var matchingTextNodes=MediumEditor.util.findOrCreateMatchingTextNodes(this.document,element,matches[matchIndex]);this.shouldNotLink(matchingTextNodes)||this.createAutoLink(matchingTextNodes,matches[matchIndex].href)}return linkCreated},shouldNotLink:function(textNodes){for(var shouldNotLink=!1,i=0;i<textNodes.length&&shouldNotLink===!1;i++)shouldNotLink=!!MediumEditor.util.traverseUp(textNodes[i],function(node){return"a"===node.nodeName.toLowerCase()||node.getAttribute&&"true"===node.getAttribute("data-auto-link")});return shouldNotLink},findLinkableText:function(contenteditable){for(var textContent=contenteditable.textContent,match=null,matches=[];null!==(match=LINK_REGEXP.exec(textContent));){var matchOk=!0,matchEnd=match.index+match[0].length;matchOk=!(0!==match.index&&WHITESPACE_CHARS.indexOf(textContent[match.index-1])===-1||matchEnd!==textContent.length&&WHITESPACE_CHARS.indexOf(textContent[matchEnd])===-1),matchOk=matchOk&&(match[0].indexOf("/")!==-1||KNOWN_TLDS_REGEXP.test(match[0].split(".").pop().split("?").shift())),matchOk&&matches.push({href:match[0],start:match.index,end:matchEnd})}return matches},createAutoLink:function(textNodes,href){href=MediumEditor.util.ensureUrlHasProtocol(href);var anchor=MediumEditor.util.createLink(this.document,textNodes,href,this.getEditorOption("targetBlank")?"_blank":null),span=this.document.createElement("span");for(span.setAttribute("data-auto-link","true"),span.setAttribute("data-href",href),anchor.insertBefore(span,anchor.firstChild);anchor.childNodes.length>1;)span.appendChild(anchor.childNodes[1])}});MediumEditor.extensions.autoLink=AutoLink}(),function(){function clearClassNames(element){var editable=MediumEditor.util.getContainerEditorElement(element),existing=Array.prototype.slice.call(editable.parentElement.querySelectorAll("."+CLASS_DRAG_OVER));existing.forEach(function(el){el.classList.remove(CLASS_DRAG_OVER)})}var CLASS_DRAG_OVER="medium-editor-dragover",FileDragging=MediumEditor.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(event){event.preventDefault(),event.dataTransfer.dropEffect="copy";var target=event.target.classList?event.target:event.target.parentElement;clearClassNames(target),"dragover"===event.type&&target.classList.add(CLASS_DRAG_OVER)},handleDrop:function(event){event.preventDefault(),event.stopPropagation(),this.base.selectElement(event.target);var selection=this.base.exportSelection();selection.start=selection.end,this.base.importSelection(selection),event.dataTransfer.files&&Array.prototype.slice.call(event.dataTransfer.files).forEach(function(file){this.isAllowedFile(file)&&file.type.match("image")&&this.insertImageFile(file)},this),clearClassNames(event.target)},isAllowedFile:function(file){return this.allowedTypes.some(function(fileType){return!!file.type.match(fileType)})},insertImageFile:function(file){if("function"==typeof FileReader){var fileReader=new FileReader;fileReader.readAsDataURL(file),fileReader.addEventListener("load",function(e){var addImageElement=this.document.createElement("img");addImageElement.src=e.target.result,MediumEditor.util.insertHTMLCommand(this.document,addImageElement.outerHTML)}.bind(this))}}});MediumEditor.extensions.fileDragging=FileDragging}(),function(){var KeyboardCommands=MediumEditor.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach(function(command){var keyCode=command.key.charCodeAt(0);this.keys[keyCode]||(this.keys[keyCode]=[]),this.keys[keyCode].push(command)},this)},handleKeydown:function(event){var keyCode=MediumEditor.util.getKeyCode(event);if(this.keys[keyCode]){var isMeta=MediumEditor.util.isMetaCtrlKey(event),isShift=!!event.shiftKey,isAlt=!!event.altKey;this.keys[keyCode].forEach(function(data){data.meta!==isMeta||data.shift!==isShift||data.alt!==isAlt&&void 0!==data.alt||(event.preventDefault(),event.stopPropagation(),"function"==typeof data.command?data.command.apply(this):!1!==data.command&&this.execAction(data.command))},this)}}});MediumEditor.extensions.keyboardCommands=KeyboardCommands}(),function(){var FontNameForm=MediumEditor.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(event){if(event.preventDefault(),event.stopPropagation(),!this.isDisplayed()){var fontName=this.document.queryCommandValue("fontName")+"";this.showForm(fontName)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getSelect().value=""},showForm:function(fontName){var select=this.getSelect();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),select.value=fontName||"",select.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontName(),this.base.checkSelection()},createForm:function(){var option,doc=this.document,form=doc.createElement("div"),select=doc.createElement("select"),close=doc.createElement("a"),save=doc.createElement("a");form.className="medium-editor-toolbar-form",form.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),this.on(form,"click",this.handleFormClick.bind(this));for(var i=0;i<this.fonts.length;i++)option=doc.createElement("option"),option.innerHTML=this.fonts[i],option.value=this.fonts[i],select.appendChild(option);return select.className="medium-editor-toolbar-select",form.appendChild(select),this.on(select,"change",this.handleFontChange.bind(this)),save.setAttribute("href","#"),save.className="medium-editor-toobar-save",save.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",form.appendChild(save),this.on(save,"click",this.handleSaveClick.bind(this),!0),close.setAttribute("href","#"),close.className="medium-editor-toobar-close",close.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",form.appendChild(close),this.on(close,"click",this.handleCloseClick.bind(this)),form},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){MediumEditor.selection.getSelectedElements(this.document).forEach(function(el){"font"===el.nodeName.toLowerCase()&&el.hasAttribute("face")&&el.removeAttribute("face")})},handleFontChange:function(){var font=this.getSelect().value;""===font?this.clearFontName():this.execAction("fontName",{value:font})},handleFormClick:function(event){event.stopPropagation()},handleSaveClick:function(event){event.preventDefault(),this.doFormSave()},handleCloseClick:function(event){event.preventDefault(),this.doFormCancel()}});MediumEditor.extensions.fontName=FontNameForm}(),function(){var FontSizeForm=MediumEditor.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(event){if(event.preventDefault(),event.stopPropagation(),!this.isDisplayed()){var fontSize=this.document.queryCommandValue("fontSize")+"";this.showForm(fontSize)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(fontSize){var input=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),input.value=fontSize||"",input.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var doc=this.document,form=doc.createElement("div"),input=doc.createElement("input"),close=doc.createElement("a"),save=doc.createElement("a");return form.className="medium-editor-toolbar-form",form.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(form,"click",this.handleFormClick.bind(this)),input.setAttribute("type","range"),input.setAttribute("min","1"),input.setAttribute("max","7"),input.className="medium-editor-toolbar-input",form.appendChild(input),this.on(input,"change",this.handleSliderChange.bind(this)),save.setAttribute("href","#"),save.className="medium-editor-toobar-save",save.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",form.appendChild(save),this.on(save,"click",this.handleSaveClick.bind(this),!0),close.setAttribute("href","#"),close.className="medium-editor-toobar-close",close.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",form.appendChild(close),this.on(close,"click",this.handleCloseClick.bind(this)),form},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){MediumEditor.selection.getSelectedElements(this.document).forEach(function(el){"font"===el.nodeName.toLowerCase()&&el.hasAttribute("size")&&el.removeAttribute("size")})},handleSliderChange:function(){var size=this.getInput().value;"4"===size?this.clearFontSize():this.execAction("fontSize",{value:size})},handleFormClick:function(event){event.stopPropagation()},handleSaveClick:function(event){event.preventDefault(),this.doFormSave()},handleCloseClick:function(event){event.preventDefault(),this.doFormCancel()}});MediumEditor.extensions.fontSize=FontSizeForm}(),function(){function createReplacements(){return[[new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g),""],[new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g),""],[new RegExp(/<br>$/i),""],[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|“|”)(((?!&quot;|&rdquo;|&ldquo;|"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|"|“|”)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],[new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi),"$1"]]}function getClipboardContent(event,win,doc){var dataTransfer=event.clipboardData||win.clipboardData||doc.dataTransfer,data={};if(!dataTransfer)return data;if(dataTransfer.getData){var legacyText=dataTransfer.getData("Text");legacyText&&legacyText.length>0&&(data["text/plain"]=legacyText)}if(dataTransfer.types)for(var i=0;i<dataTransfer.types.length;i++){var contentType=dataTransfer.types[i];data[contentType]=dataTransfer.getData(contentType)}return data}var pasteBinDefaultContent="%ME_PASTEBIN%",lastRange=null,keyboardPasteEditable=null,stopProp=function(event){event.stopPropagation()},PasteHandler=MediumEditor.Extension.extend({forcePlainText:!0,cleanPastedHTML:!1,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[],init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&(this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.getEditorElements().forEach(function(element){this.on(element,"paste",this.handlePaste.bind(this))},this),this.subscribe("addElement",this.handleAddElement.bind(this)))},handleAddElement:function(event,editable){this.on(editable,"paste",this.handlePaste.bind(this))},destroy:function(){(this.forcePlainText||this.cleanPastedHTML)&&this.removePasteBin()},handlePaste:function(event,editable){if(!event.defaultPrevented){var clipboardContent=getClipboardContent(event,this.window,this.document),pastedHTML=clipboardContent["text/html"],pastedPlain=clipboardContent["text/plain"];this.window.clipboardData&&void 0===event.clipboardData&&!pastedHTML&&(pastedHTML=pastedPlain),(pastedHTML||pastedPlain)&&(event.preventDefault(),this.doPaste(pastedHTML,pastedPlain,editable))}},doPaste:function(pastedHTML,pastedPlain,editable){var paragraphs,p,html="";if(this.cleanPastedHTML&&pastedHTML)return this.cleanPaste(pastedHTML);if(this.getEditorOption("disableReturn")||editable&&editable.getAttribute("data-disable-return"))html=MediumEditor.util.htmlEntities(pastedPlain);else if(paragraphs=pastedPlain.split(/[\r\n]+/g),paragraphs.length>1)for(p=0;p<paragraphs.length;p+=1)""!==paragraphs[p]&&(html+="<p>"+MediumEditor.util.htmlEntities(paragraphs[p])+"</p>");else html=MediumEditor.util.htmlEntities(paragraphs[0]);MediumEditor.util.insertHTMLCommand(this.document,html)},handlePasteBinPaste:function(event){if(event.defaultPrevented)return void this.removePasteBin();var clipboardContent=getClipboardContent(event,this.window,this.document),pastedHTML=clipboardContent["text/html"],pastedPlain=clipboardContent["text/plain"],editable=keyboardPasteEditable;return!this.cleanPastedHTML||pastedHTML?(event.preventDefault(),this.removePasteBin(),this.doPaste(pastedHTML,pastedPlain,editable),void this.trigger("editablePaste",{currentTarget:editable,target:editable},editable)):void setTimeout(function(){this.cleanPastedHTML&&(pastedHTML=this.getPasteBinHtml()),this.removePasteBin(),this.doPaste(pastedHTML,pastedPlain,editable),this.trigger("editablePaste",{currentTarget:editable,target:editable},editable)}.bind(this),0)},handleKeydown:function(event,editable){MediumEditor.util.isKey(event,MediumEditor.util.keyCode.V)&&MediumEditor.util.isMetaCtrlKey(event)&&(event.stopImmediatePropagation(),this.removePasteBin(),this.createPasteBin(editable))},createPasteBin:function(editable){var rects,range=MediumEditor.selection.getSelectionRange(this.document),top=this.window.pageYOffset;keyboardPasteEditable=editable,range&&(rects=range.getClientRects(),top+=rects.length?rects[0].top:range.startContainer.getBoundingClientRect().top),lastRange=range;var pasteBinElm=this.document.createElement("div");pasteBinElm.id=this.pasteBinId="medium-editor-pastebin-"+ +Date.now(),pasteBinElm.setAttribute("style","border: 1px red solid; position: absolute; top: "+top+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0"),pasteBinElm.setAttribute("contentEditable",!0),pasteBinElm.innerHTML=pasteBinDefaultContent,this.document.body.appendChild(pasteBinElm),this.on(pasteBinElm,"focus",stopProp),this.on(pasteBinElm,"focusin",stopProp),this.on(pasteBinElm,"focusout",stopProp),pasteBinElm.focus(),MediumEditor.selection.selectNode(pasteBinElm,this.document),this.boundHandlePaste||(this.boundHandlePaste=this.handlePasteBinPaste.bind(this)),this.on(pasteBinElm,"paste",this.boundHandlePaste)},removePasteBin:function(){null!==lastRange&&(MediumEditor.selection.selectRange(this.document,lastRange),lastRange=null),null!==keyboardPasteEditable&&(keyboardPasteEditable=null);var pasteBinElm=this.getPasteBin();pasteBinElm&&pasteBinElm&&(this.off(pasteBinElm,"focus",stopProp),this.off(pasteBinElm,"focusin",stopProp),this.off(pasteBinElm,"focusout",stopProp),this.off(pasteBinElm,"paste",this.boundHandlePaste),pasteBinElm.parentElement.removeChild(pasteBinElm))},getPasteBin:function(){return this.document.getElementById(this.pasteBinId)},getPasteBinHtml:function(){var pasteBinElm=this.getPasteBin();if(!pasteBinElm)return!1;if(pasteBinElm.firstChild&&"mcepastebin"===pasteBinElm.firstChild.id)return!1;var pasteBinHtml=pasteBinElm.innerHTML;return!(!pasteBinHtml||pasteBinHtml===pasteBinDefaultContent)&&pasteBinHtml},cleanPaste:function(text){var i,elList,tmp,workEl,multiline=/<p|<br|<div/.test(text),replacements=[].concat(this.preCleanReplacements||[],createReplacements(),this.cleanReplacements||[]);for(i=0;i<replacements.length;i+=1)text=text.replace(replacements[i][0],replacements[i][1]);if(!multiline)return this.pasteHTML(text);for(tmp=this.document.createElement("div"),tmp.innerHTML="<p>"+text.split("<br><br>").join("</p><p>")+"</p>",elList=tmp.querySelectorAll("a,p,div,br"),i=0;i<elList.length;i+=1)switch(workEl=elList[i],workEl.innerHTML=workEl.innerHTML.replace(/\n/gi," "),workEl.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(workEl);break;case"br":this.filterLineBreak(workEl)}this.pasteHTML(tmp.innerHTML)},pasteHTML:function(html,options){options=MediumEditor.util.defaults({},options,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags,unwrapTags:this.unwrapTags});var elList,workEl,i,fragmentBody,pasteBlock=this.document.createDocumentFragment();for(pasteBlock.appendChild(this.document.createElement("body")),fragmentBody=pasteBlock.querySelector("body"),fragmentBody.innerHTML=html,this.cleanupSpans(fragmentBody),elList=fragmentBody.querySelectorAll("*"),i=0;i<elList.length;i+=1)workEl=elList[i],"a"===workEl.nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&MediumEditor.util.setTargetBlank(workEl),MediumEditor.util.cleanupAttrs(workEl,options.cleanAttrs),MediumEditor.util.cleanupTags(workEl,options.cleanTags),MediumEditor.util.unwrapTags(workEl,options.unwrapTags);MediumEditor.util.insertHTMLCommand(this.document,fragmentBody.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(el){return el&&("p"===el.nodeName.toLowerCase()||"div"===el.nodeName.toLowerCase())},filterCommonBlocks:function(el){/^\s*$/.test(el.textContent)&&el.parentNode&&el.parentNode.removeChild(el)},filterLineBreak:function(el){this.isCommonBlock(el.previousElementSibling)?this.removeWithParent(el):!this.isCommonBlock(el.parentNode)||el.parentNode.firstChild!==el&&el.parentNode.lastChild!==el?el.parentNode&&1===el.parentNode.childElementCount&&""===el.parentNode.textContent&&this.removeWithParent(el):this.removeWithParent(el)},removeWithParent:function(el){el&&el.parentNode&&(el.parentNode.parentNode&&1===el.parentNode.childElementCount?el.parentNode.parentNode.removeChild(el.parentNode):el.parentNode.removeChild(el))},cleanupSpans:function(containerEl){var i,el,newEl,spans=containerEl.querySelectorAll(".replace-with"),isCEF=function(el){return el&&"#text"!==el.nodeName&&"false"===el.getAttribute("contenteditable")};for(i=0;i<spans.length;i+=1)el=spans[i],newEl=this.document.createElement(el.classList.contains("bold")?"b":"i"),el.classList.contains("bold")&&el.classList.contains("italic")?newEl.innerHTML="<i>"+el.innerHTML+"</i>":newEl.innerHTML=el.innerHTML,el.parentNode.replaceChild(newEl,el);for(spans=containerEl.querySelectorAll("span"),i=0;i<spans.length;i+=1){if(el=spans[i],MediumEditor.util.traverseUp(el,isCEF))return!1;MediumEditor.util.unwrap(el,this.document)}}});MediumEditor.extensions.paste=PasteHandler}(),function(){var Placeholder=MediumEditor.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(this.initElement,this)},handleAddElement:function(event,editable){this.initElement(editable)},initElement:function(el){el.getAttribute("data-placeholder")||el.setAttribute("data-placeholder",this.text),this.updatePlaceholder(el)},destroy:function(){this.getEditorElements().forEach(this.cleanupElement,this)},handleRemoveElement:function(event,editable){this.cleanupElement(editable)},cleanupElement:function(el){el.getAttribute("data-placeholder")===this.text&&el.removeAttribute("data-placeholder")},showPlaceholder:function(el){el&&(MediumEditor.util.isFF&&0===el.childNodes.length?(el.classList.add("medium-editor-placeholder-relative"),el.classList.remove("medium-editor-placeholder")):(el.classList.add("medium-editor-placeholder"),el.classList.remove("medium-editor-placeholder-relative")))},hidePlaceholder:function(el){el&&(el.classList.remove("medium-editor-placeholder"),el.classList.remove("medium-editor-placeholder-relative"))},updatePlaceholder:function(el,dontShow){return el.querySelector("img, blockquote, ul, ol, table")||""!==el.textContent.replace(/^\s+|\s+$/g,"")?this.hidePlaceholder(el):void(dontShow||this.showPlaceholder(el))},attachEventHandlers:function(){this.hideOnClick&&this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableInput",this.handleInput.bind(this)),this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("addElement",this.handleAddElement.bind(this)),this.subscribe("removeElement",this.handleRemoveElement.bind(this))},handleInput:function(event,element){var dontShow=this.hideOnClick&&element===this.base.getFocusedElement();this.updatePlaceholder(element,dontShow)},handleFocus:function(event,element){this.hidePlaceholder(element)},handleBlur:function(event,element){this.updatePlaceholder(element)}});MediumEditor.extensions.placeholder=Placeholder}(),function(){var Toolbar=MediumEditor.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,sticky:!1,stickyTopOffset:0,updateOnEmptySelection:!1,relativeContainer:null,init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.relativeContainer?this.relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(iterator,context){return this.base.extensions.forEach(function(command){if(command!==this)return iterator.apply(context||this,arguments)},this)},createToolbar:function(){var toolbar=this.document.createElement("div");return toolbar.id="medium-editor-toolbar-"+this.getEditorId(),toolbar.className="medium-editor-toolbar",this.static?toolbar.className+=" static-toolbar":this.relativeContainer?toolbar.className+=" medium-editor-relative-toolbar":toolbar.className+=" medium-editor-stalker-toolbar",toolbar.appendChild(this.createToolbarButtons()),this.forEachExtension(function(extension){extension.hasForm&&toolbar.appendChild(extension.getForm())}),this.attachEventHandlers(),toolbar},createToolbarButtons:function(){var li,btn,buttons,extension,buttonName,buttonOpts,ul=this.document.createElement("ul");return ul.id="medium-editor-toolbar-actions"+this.getEditorId(),ul.className="medium-editor-toolbar-actions",ul.style.display="block",this.buttons.forEach(function(button){
"string"==typeof button?(buttonName=button,buttonOpts=null):(buttonName=button.name,buttonOpts=button),extension=this.base.addBuiltInExtension(buttonName,buttonOpts),extension&&"function"==typeof extension.getButton&&(btn=extension.getButton(this.base),li=this.document.createElement("li"),MediumEditor.util.isElement(btn)?li.appendChild(btn):li.innerHTML=btn,ul.appendChild(li))},this),buttons=ul.querySelectorAll("button"),buttons.length>0&&(buttons[0].classList.add(this.firstButtonClass),buttons[buttons.length-1].classList.add(this.lastButtonClass)),ul},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getInteractionElements:function(){return this.getToolbarElement()},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=MediumEditor.util.throttle(function(){this.base.isActive&&this.positionToolbarIfShown()}.bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.static&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(event){return!(event&&event.target&&MediumEditor.util.isDescendant(this.getToolbarElement(),event.target))&&void this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay(function(){this.showToolbar()}.bind(this))},hideExtensionForms:function(){this.forEachExtension(function(extension){extension.hasForm&&extension.isDisplayed()&&extension.hideForm()})},multipleBlockElementsSelected:function(){var regexEmptyHTMLTags=/<[^\/>][^>]*><\/[^>]+>/gim,regexBlockElements=new RegExp("<("+MediumEditor.util.blockContainerElementNames.join("|")+")[^>]*>","g"),selectionHTML=MediumEditor.selection.getSelectionHtml(this.document).replace(regexEmptyHTMLTags,""),hasMultiParagraphs=selectionHTML.match(regexBlockElements);return!!hasMultiParagraphs&&hasMultiParagraphs.length>1},modifySelection:function(){var selection=this.window.getSelection(),selectionRange=selection.getRangeAt(0);if(this.standardizeSelectionStart&&selectionRange.startContainer.nodeValue&&selectionRange.startOffset===selectionRange.startContainer.nodeValue.length){var adjacentNode=MediumEditor.util.findAdjacentTextNodeWithContent(MediumEditor.selection.getSelectionElement(this.window),selectionRange.startContainer,this.document);if(adjacentNode){for(var offset=0;0===adjacentNode.nodeValue.substr(offset,1).trim().length;)offset+=1;selectionRange=MediumEditor.selection.select(this.document,adjacentNode,offset,selectionRange.endContainer,selectionRange.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||MediumEditor.selection.selectionInContentEditableFalse(this.window))return this.hideToolbar();var selectionElement=MediumEditor.selection.getSelectionElement(this.window);return!selectionElement||this.getEditorElements().indexOf(selectionElement)===-1||selectionElement.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this.static?this.showAndUpdateToolbar():!MediumEditor.selection.selectionContainsContent(this.document)||this.allowMultiParagraphSelection===!1&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension(function(extension){"function"==typeof extension.isActive&&"function"==typeof extension.setInactive&&extension.setInactive()}),this.checkActiveButtons()},checkActiveButtons:function(){var parentNode,manualStateChecks=[],queryState=null,selectionRange=MediumEditor.selection.getSelectionRange(this.document),updateExtensionState=function(extension){"function"==typeof extension.checkState?extension.checkState(parentNode):"function"==typeof extension.isActive&&"function"==typeof extension.isAlreadyApplied&&"function"==typeof extension.setActive&&!extension.isActive()&&extension.isAlreadyApplied(parentNode)&&extension.setActive()};if(selectionRange&&(this.forEachExtension(function(extension){return"function"==typeof extension.queryCommandState&&(queryState=extension.queryCommandState(),null!==queryState)?void(queryState&&"function"==typeof extension.setActive&&extension.setActive()):void manualStateChecks.push(extension)}),parentNode=MediumEditor.selection.getSelectedParentElement(selectionRange),this.getEditorElements().some(function(element){return MediumEditor.util.isDescendant(element,parentNode,!0)})))for(;parentNode&&(manualStateChecks.forEach(updateExtensionState),!MediumEditor.util.isMediumEditorElement(parentNode));)parentNode=parentNode.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var container=this.base.getFocusedElement(),selection=this.window.getSelection();return container?void(!this.static&&selection.isCollapsed||(this.showToolbar(),this.relativeContainer||(this.static?this.positionStaticToolbar(container):this.positionToolbar(selection)),this.trigger("positionedToolbar",{},this.base.getFocusedElement()))):this},positionStaticToolbar:function(container){this.getToolbarElement().style.left="0";var targetLeft,scrollTop=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,windowWidth=this.window.innerWidth,toolbarElement=this.getToolbarElement(),containerRect=container.getBoundingClientRect(),containerTop=containerRect.top+scrollTop,containerCenter=containerRect.left+containerRect.width/2,toolbarHeight=toolbarElement.offsetHeight,toolbarWidth=toolbarElement.offsetWidth,halfOffsetWidth=toolbarWidth/2;switch(this.sticky?scrollTop>containerTop+container.offsetHeight-toolbarHeight-this.stickyTopOffset?(toolbarElement.style.top=containerTop+container.offsetHeight-toolbarHeight+"px",toolbarElement.classList.remove("medium-editor-sticky-toolbar")):scrollTop>containerTop-toolbarHeight-this.stickyTopOffset?(toolbarElement.classList.add("medium-editor-sticky-toolbar"),toolbarElement.style.top=this.stickyTopOffset+"px"):(toolbarElement.classList.remove("medium-editor-sticky-toolbar"),toolbarElement.style.top=containerTop-toolbarHeight+"px"):toolbarElement.style.top=containerTop-toolbarHeight+"px",this.align){case"left":targetLeft=containerRect.left;break;case"right":targetLeft=containerRect.right-toolbarWidth;break;case"center":targetLeft=containerCenter-halfOffsetWidth}targetLeft<0?targetLeft=0:targetLeft+toolbarWidth>windowWidth&&(targetLeft=windowWidth-Math.ceil(toolbarWidth)-1),toolbarElement.style.left=targetLeft+"px"},positionToolbar:function(selection){this.getToolbarElement().style.left="0",this.getToolbarElement().style.right="initial";var range=selection.getRangeAt(0),boundary=range.getBoundingClientRect();(!boundary||0===boundary.height&&0===boundary.width&&range.startContainer===range.endContainer)&&(boundary=1===range.startContainer.nodeType&&range.startContainer.querySelector("img")?range.startContainer.querySelector("img").getBoundingClientRect():range.startContainer.getBoundingClientRect());var middleBoundary,elementsContainerBoundary,containerWidth=this.window.innerWidth,toolbarElement=this.getToolbarElement(),toolbarHeight=toolbarElement.offsetHeight,toolbarWidth=toolbarElement.offsetWidth,halfOffsetWidth=toolbarWidth/2,buttonHeight=50,defaultLeft=this.diffLeft-halfOffsetWidth,elementsContainer=this.getEditorOption("elementsContainer"),elementsContainerAbsolute=["absolute","fixed"].indexOf(window.getComputedStyle(elementsContainer).getPropertyValue("position"))>-1,positions={},relativeBoundary={};elementsContainerAbsolute?(elementsContainerBoundary=elementsContainer.getBoundingClientRect(),["top","left"].forEach(function(key){relativeBoundary[key]=boundary[key]-elementsContainerBoundary[key]}),relativeBoundary.width=boundary.width,relativeBoundary.height=boundary.height,boundary=relativeBoundary,containerWidth=elementsContainerBoundary.width,positions.top=elementsContainer.scrollTop):positions.top=this.window.pageYOffset,middleBoundary=boundary.left+boundary.width/2,positions.top+=boundary.top-toolbarHeight,boundary.top<buttonHeight?(toolbarElement.classList.add("medium-toolbar-arrow-over"),toolbarElement.classList.remove("medium-toolbar-arrow-under"),positions.top+=buttonHeight+boundary.height-this.diffTop):(toolbarElement.classList.add("medium-toolbar-arrow-under"),toolbarElement.classList.remove("medium-toolbar-arrow-over"),positions.top+=this.diffTop),middleBoundary<halfOffsetWidth?(positions.left=defaultLeft+halfOffsetWidth,positions.right="initial"):containerWidth-middleBoundary<halfOffsetWidth?(positions.left="auto",positions.right=0):(positions.left=defaultLeft+middleBoundary,positions.right="initial"),["top","left","right"].forEach(function(key){toolbarElement.style[key]=positions[key]+(isNaN(positions[key])?"":"px")})}});MediumEditor.extensions.toolbar=Toolbar}(),function(){var ImageDragging=MediumEditor.Extension.extend({init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(event){var className="medium-editor-dragover";event.preventDefault(),event.dataTransfer.dropEffect="copy","dragover"===event.type?event.target.classList.add(className):"dragleave"===event.type&&event.target.classList.remove(className)},handleDrop:function(event){var files,className="medium-editor-dragover";event.preventDefault(),event.stopPropagation(),event.dataTransfer.files&&(files=Array.prototype.slice.call(event.dataTransfer.files,0),files.some(function(file){if(file.type.match("image")){var fileReader,id;fileReader=new FileReader,fileReader.readAsDataURL(file),id="medium-img-"+ +new Date,MediumEditor.util.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+id+'" />'),fileReader.onload=function(){var img=this.document.getElementById(id);img&&(img.removeAttribute("id"),img.removeAttribute("class"),img.src=fileReader.result)}.bind(this)}}.bind(this))),event.target.classList.remove(className)}});MediumEditor.extensions.imageDragging=ImageDragging}(),function(){function handleDisableExtraSpaces(event){var node=MediumEditor.selection.getSelectionStart(this.options.ownerDocument),textContent=node.textContent,caretPositions=MediumEditor.selection.getCaretOffsets(node);(void 0===textContent[caretPositions.left-1]||""===textContent[caretPositions.left-1].trim()||void 0!==textContent[caretPositions.left]&&""===textContent[caretPositions.left].trim())&&event.preventDefault()}function handleDisabledEnterKeydown(event,element){if(this.options.disableReturn||element.getAttribute("data-disable-return"))event.preventDefault();else if(this.options.disableDoubleReturn||element.getAttribute("data-disable-double-return")){var node=MediumEditor.selection.getSelectionStart(this.options.ownerDocument);(node&&""===node.textContent.trim()&&"li"!==node.nodeName.toLowerCase()||node.previousElementSibling&&"br"!==node.previousElementSibling.nodeName.toLowerCase()&&""===node.previousElementSibling.textContent.trim())&&event.preventDefault()}}function handleTabKeydown(event){var node=MediumEditor.selection.getSelectionStart(this.options.ownerDocument),tag=node&&node.nodeName.toLowerCase();"pre"===tag&&(event.preventDefault(),MediumEditor.util.insertHTMLCommand(this.options.ownerDocument,"    ")),MediumEditor.util.isListItem(node)&&(event.preventDefault(),event.shiftKey?this.options.ownerDocument.execCommand("outdent",!1,null):this.options.ownerDocument.execCommand("indent",!1,null))}function handleBlockDeleteKeydowns(event){var p,node=MediumEditor.selection.getSelectionStart(this.options.ownerDocument),tagName=node.nodeName.toLowerCase(),isEmpty=/^(\s+|<br\/?>)?$/i,isHeader=/h\d/i;MediumEditor.util.isKey(event,[MediumEditor.util.keyCode.BACKSPACE,MediumEditor.util.keyCode.ENTER])&&node.previousElementSibling&&isHeader.test(tagName)&&0===MediumEditor.selection.getCaretOffsets(node).left?MediumEditor.util.isKey(event,MediumEditor.util.keyCode.BACKSPACE)&&isEmpty.test(node.previousElementSibling.innerHTML)?(node.previousElementSibling.parentNode.removeChild(node.previousElementSibling),event.preventDefault()):!this.options.disableDoubleReturn&&MediumEditor.util.isKey(event,MediumEditor.util.keyCode.ENTER)&&(p=this.options.ownerDocument.createElement("p"),p.innerHTML="<br>",node.previousElementSibling.parentNode.insertBefore(p,node),event.preventDefault()):MediumEditor.util.isKey(event,MediumEditor.util.keyCode.DELETE)&&node.nextElementSibling&&node.previousElementSibling&&!isHeader.test(tagName)&&isEmpty.test(node.innerHTML)&&isHeader.test(node.nextElementSibling.nodeName.toLowerCase())?(MediumEditor.selection.moveCursor(this.options.ownerDocument,node.nextElementSibling),node.previousElementSibling.parentNode.removeChild(node),event.preventDefault()):MediumEditor.util.isKey(event,MediumEditor.util.keyCode.BACKSPACE)&&"li"===tagName&&isEmpty.test(node.innerHTML)&&!node.previousElementSibling&&!node.parentElement.previousElementSibling&&node.nextElementSibling&&"li"===node.nextElementSibling.nodeName.toLowerCase()?(p=this.options.ownerDocument.createElement("p"),p.innerHTML="<br>",node.parentElement.parentElement.insertBefore(p,node.parentElement),MediumEditor.selection.moveCursor(this.options.ownerDocument,p),node.parentElement.removeChild(node),event.preventDefault()):MediumEditor.util.isKey(event,MediumEditor.util.keyCode.BACKSPACE)&&MediumEditor.util.getClosestTag(node,"blockquote")!==!1&&0===MediumEditor.selection.getCaretOffsets(node).left?(event.preventDefault(),MediumEditor.util.execFormatBlock(this.options.ownerDocument,"p")):MediumEditor.util.isKey(event,MediumEditor.util.keyCode.ENTER)&&MediumEditor.util.getClosestTag(node,"blockquote")!==!1&&0===MediumEditor.selection.getCaretOffsets(node).right?(p=this.options.ownerDocument.createElement("p"),p.innerHTML="<br>",node.parentElement.insertBefore(p,node.nextSibling),MediumEditor.selection.moveCursor(this.options.ownerDocument,p),event.preventDefault()):MediumEditor.util.isKey(event,MediumEditor.util.keyCode.BACKSPACE)&&MediumEditor.util.isMediumEditorElement(node.parentElement)&&!node.previousElementSibling&&node.nextElementSibling&&isEmpty.test(node.innerHTML)&&(event.preventDefault(),MediumEditor.selection.moveCursor(this.options.ownerDocument,node.nextSibling),node.parentElement.removeChild(node))}function handleKeyup(event){var tagName,node=MediumEditor.selection.getSelectionStart(this.options.ownerDocument);node&&(MediumEditor.util.isMediumEditorElement(node)&&0===node.children.length&&!MediumEditor.util.isBlockContainer(node)&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),!MediumEditor.util.isKey(event,MediumEditor.util.keyCode.ENTER)||MediumEditor.util.isListItem(node)||MediumEditor.util.isBlockContainer(node)||(tagName=node.nodeName.toLowerCase(),"a"===tagName?this.options.ownerDocument.execCommand("unlink",!1,null):event.shiftKey||event.ctrlKey||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function handleEditableInput(event,editable){var textarea=editable.parentNode.querySelector('textarea[medium-editor-textarea-id="'+editable.getAttribute("medium-editor-textarea-id")+'"]');textarea&&(textarea.value=editable.innerHTML.trim())}function addToEditors(win){win._mediumEditors||(win._mediumEditors=[null]),this.id||(this.id=win._mediumEditors.length),win._mediumEditors[this.id]=this}function removeFromEditors(win){win._mediumEditors&&win._mediumEditors[this.id]&&(win._mediumEditors[this.id]=null)}function createElementsArray(selector,doc,filterEditorElements){var elements=[];if(selector||(selector=[]),"string"==typeof selector&&(selector=doc.querySelectorAll(selector)),MediumEditor.util.isElement(selector)&&(selector=[selector]),filterEditorElements)for(var i=0;i<selector.length;i++){var el=selector[i];!MediumEditor.util.isElement(el)||el.getAttribute("data-medium-editor-element")||el.getAttribute("medium-editor-textarea-id")||elements.push(el)}else elements=Array.prototype.slice.apply(selector);return elements}function cleanupTextareaElement(element){var textarea=element.parentNode.querySelector('textarea[medium-editor-textarea-id="'+element.getAttribute("medium-editor-textarea-id")+'"]');textarea&&(textarea.classList.remove("medium-editor-hidden"),textarea.removeAttribute("medium-editor-textarea-id")),element.parentNode&&element.parentNode.removeChild(element)}function setExtensionDefaults(extension,defaults){return Object.keys(defaults).forEach(function(prop){void 0===extension[prop]&&(extension[prop]=defaults[prop])}),extension}function initExtension(extension,name,instance){var extensionDefaults={window:instance.options.contentWindow,document:instance.options.ownerDocument,base:instance};return extension=setExtensionDefaults(extension,extensionDefaults),"function"==typeof extension.init&&extension.init(),extension.name||(extension.name=name),extension}function isToolbarEnabled(){return!this.elements.every(function(element){return!!element.getAttribute("data-disable-toolbar")})&&this.options.toolbar!==!1}function isAnchorPreviewEnabled(){return!!isToolbarEnabled.call(this)&&this.options.anchorPreview!==!1}function isPlaceholderEnabled(){return this.options.placeholder!==!1}function isAutoLinkEnabled(){return this.options.autoLink!==!1}function isImageDraggingEnabled(){return this.options.imageDragging!==!1}function isKeyboardCommandsEnabled(){return this.options.keyboardCommands!==!1}function shouldUseFileDraggingExtension(){return!this.options.extensions.imageDragging}function createContentEditable(textarea){for(var div=this.options.ownerDocument.createElement("div"),now=Date.now(),uniqueId="medium-editor-"+now,atts=textarea.attributes;this.options.ownerDocument.getElementById(uniqueId);)now++,uniqueId="medium-editor-"+now;div.className=textarea.className,div.id=uniqueId,div.innerHTML=textarea.value,textarea.setAttribute("medium-editor-textarea-id",uniqueId);for(var i=0,n=atts.length;i<n;i++)div.hasAttribute(atts[i].nodeName)||div.setAttribute(atts[i].nodeName,atts[i].nodeValue);return textarea.form&&this.on(textarea.form,"reset",function(event){event.defaultPrevented||this.resetContent(this.options.ownerDocument.getElementById(uniqueId))}.bind(this)),textarea.classList.add("medium-editor-hidden"),textarea.parentNode.insertBefore(div,textarea),div}function initElement(element,editorId){if(!element.getAttribute("data-medium-editor-element")){"textarea"===element.nodeName.toLowerCase()&&(element=createContentEditable.call(this,element),this.instanceHandleEditableInput||(this.instanceHandleEditableInput=handleEditableInput.bind(this),this.subscribe("editableInput",this.instanceHandleEditableInput))),this.options.disableEditing||element.getAttribute("data-disable-editing")||(element.setAttribute("contentEditable",!0),element.setAttribute("spellcheck",this.options.spellcheck)),this.instanceHandleEditableKeydownEnter||(element.getAttribute("data-disable-return")||element.getAttribute("data-disable-double-return"))&&(this.instanceHandleEditableKeydownEnter=handleDisabledEnterKeydown.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter)),this.options.disableReturn||element.getAttribute("data-disable-return")||this.on(element,"keyup",handleKeyup.bind(this));var elementId=MediumEditor.util.guid();element.setAttribute("data-medium-editor-element",!0),element.classList.add("medium-editor-element"),element.setAttribute("role","textbox"),element.setAttribute("aria-multiline",!0),element.setAttribute("data-medium-editor-editor-index",editorId),element.setAttribute("medium-editor-index",elementId),initialContent[elementId]=element.innerHTML,this.events.attachAllEventsToElement(element)}return element}function attachHandlers(){this.subscribe("editableKeydownTab",handleTabKeydown.bind(this)),this.subscribe("editableKeydownDelete",handleBlockDeleteKeydowns.bind(this)),this.subscribe("editableKeydownEnter",handleBlockDeleteKeydowns.bind(this)),this.options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",handleDisableExtraSpaces.bind(this)),this.instanceHandleEditableKeydownEnter||(this.options.disableReturn||this.options.disableDoubleReturn)&&(this.instanceHandleEditableKeydownEnter=handleDisabledEnterKeydown.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter))}function initExtensions(){if(this.extensions=[],Object.keys(this.options.extensions).forEach(function(name){"toolbar"!==name&&this.options.extensions[name]&&this.extensions.push(initExtension(this.options.extensions[name],name,this))},this),shouldUseFileDraggingExtension.call(this)){var opts=this.options.fileDragging;opts||(opts={},isImageDraggingEnabled.call(this)||(opts.allowedTypes=[])),this.addBuiltInExtension("fileDragging",opts)}var builtIns={paste:!0,"anchor-preview":isAnchorPreviewEnabled.call(this),autoLink:isAutoLinkEnabled.call(this),keyboardCommands:isKeyboardCommandsEnabled.call(this),placeholder:isPlaceholderEnabled.call(this)};Object.keys(builtIns).forEach(function(name){builtIns[name]&&this.addBuiltInExtension(name)},this);var toolbarExtension=this.options.extensions.toolbar;if(!toolbarExtension&&isToolbarEnabled.call(this)){var toolbarOptions=MediumEditor.util.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});toolbarExtension=new MediumEditor.extensions.toolbar(toolbarOptions)}toolbarExtension&&this.extensions.push(initExtension(toolbarExtension,"toolbar",this))}function mergeOptions(defaults,options){var deprecatedProperties=[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]];return options&&deprecatedProperties.forEach(function(pair){options.hasOwnProperty(pair[0])&&void 0!==options[pair[0]]&&MediumEditor.util.deprecated(pair[0],pair[1],"v6.0.0")}),MediumEditor.util.defaults({},options,defaults)}function execActionInternal(action,opts){var match,cmdValueArgument,appendAction=/^append-(.+)$/gi,justifyAction=/justify([A-Za-z]*)$/g;if(match=appendAction.exec(action))return MediumEditor.util.execFormatBlock(this.options.ownerDocument,match[1]);if("fontSize"===action)return opts.size&&MediumEditor.util.deprecated(".size option for fontSize command",".value","6.0.0"),cmdValueArgument=opts.value||opts.size,this.options.ownerDocument.execCommand("fontSize",!1,cmdValueArgument);if("fontName"===action)return opts.name&&MediumEditor.util.deprecated(".name option for fontName command",".value","6.0.0"),cmdValueArgument=opts.value||opts.name,this.options.ownerDocument.execCommand("fontName",!1,cmdValueArgument);if("createLink"===action)return this.createLink(opts);if("image"===action){var src=this.options.contentWindow.getSelection().toString().trim();return this.options.ownerDocument.execCommand("insertImage",!1,src)}if(justifyAction.exec(action)){var result=this.options.ownerDocument.execCommand(action,!1,null),parentNode=MediumEditor.selection.getSelectedParentElement(MediumEditor.selection.getSelectionRange(this.options.ownerDocument));return parentNode&&cleanupJustifyDivFragments.call(this,MediumEditor.util.getTopBlockContainer(parentNode)),result}return cmdValueArgument=opts&&opts.value,this.options.ownerDocument.execCommand(action,!1,cmdValueArgument)}function cleanupJustifyDivFragments(blockContainer){if(blockContainer){var textAlign,childDivs=Array.prototype.slice.call(blockContainer.childNodes).filter(function(element){var isDiv="div"===element.nodeName.toLowerCase();return isDiv&&!textAlign&&(textAlign=element.style.textAlign),isDiv});childDivs.length&&(this.saveSelection(),childDivs.forEach(function(div){if(div.style.textAlign===textAlign){var lastChild=div.lastChild;if(lastChild){MediumEditor.util.unwrap(div,this.options.ownerDocument);var br=this.options.ownerDocument.createElement("BR");lastChild.parentNode.insertBefore(br,lastChild.nextSibling)}}},this),blockContainer.style.textAlign=textAlign,this.restoreSelection())}}var initialContent={};MediumEditor.prototype={init:function(elements,options){return this.options=mergeOptions.call(this,this.defaults,options),this.origElements=elements,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(addToEditors.call(this,this.options.contentWindow),this.events=new MediumEditor.Events(this),this.elements=[],this.addElements(this.origElements),0!==this.elements.length&&(this.isActive=!0,initExtensions.call(this),attachHandlers.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach(function(extension){"function"==typeof extension.destroy&&extension.destroy()},this),this.events.destroy(),this.elements.forEach(function(element){this.options.spellcheck&&(element.innerHTML=element.innerHTML),element.removeAttribute("contentEditable"),element.removeAttribute("spellcheck"),element.removeAttribute("data-medium-editor-element"),element.classList.remove("medium-editor-element"),element.removeAttribute("role"),element.removeAttribute("aria-multiline"),element.removeAttribute("medium-editor-index"),element.removeAttribute("data-medium-editor-editor-index"),element.getAttribute("medium-editor-textarea-id")&&cleanupTextareaElement(element)},this),this.elements=[],this.instanceHandleEditableKeydownEnter=null,this.instanceHandleEditableInput=null,removeFromEditors.call(this,this.options.contentWindow))},on:function(target,event,listener,useCapture){return this.events.attachDOMEvent(target,event,listener,useCapture),this},off:function(target,event,listener,useCapture){return this.events.detachDOMEvent(target,event,listener,useCapture),this},subscribe:function(event,listener){return this.events.attachCustomEvent(event,listener),this},unsubscribe:function(event,listener){return this.events.detachCustomEvent(event,listener),this},trigger:function(name,data,editable){return this.events.triggerCustomEvent(name,data,editable),this},delay:function(fn){var self=this;return setTimeout(function(){self.isActive&&fn()},this.options.delay)},serialize:function(){var i,elementid,content={},len=this.elements.length;for(i=0;i<len;i+=1)elementid=""!==this.elements[i].id?this.elements[i].id:"element-"+i,content[elementid]={value:this.elements[i].innerHTML.trim()};return content},getExtensionByName:function(name){var extension;return this.extensions&&this.extensions.length&&this.extensions.some(function(ext){return ext.name===name&&(extension=ext,!0)}),extension},addBuiltInExtension:function(name,opts){var merged,extension=this.getExtensionByName(name);if(extension)return extension;switch(name){case"anchor":merged=MediumEditor.util.extend({},this.options.anchor,opts),extension=new MediumEditor.extensions.anchor(merged);break;case"anchor-preview":extension=new MediumEditor.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":extension=new MediumEditor.extensions.autoLink;break;case"fileDragging":extension=new MediumEditor.extensions.fileDragging(opts);break;case"fontname":extension=new MediumEditor.extensions.fontName(this.options.fontName);break;case"fontsize":extension=new MediumEditor.extensions.fontSize(opts);break;case"keyboardCommands":extension=new MediumEditor.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":extension=new MediumEditor.extensions.paste(this.options.paste);break;case"placeholder":extension=new MediumEditor.extensions.placeholder(this.options.placeholder);break;default:MediumEditor.extensions.button.isBuiltInButton(name)&&(opts?(merged=MediumEditor.util.defaults({},opts,MediumEditor.extensions.button.prototype.defaults[name]),extension=new MediumEditor.extensions.button(merged)):extension=new MediumEditor.extensions.button(name))}return extension&&this.extensions.push(initExtension(extension,name,this)),extension},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var toolbar=this.getExtensionByName("toolbar");return toolbar&&toolbar.checkState(),this},queryCommandState:function(action){var match,fullAction=/^full-(.+)$/gi,queryState=null;match=fullAction.exec(action),match&&(action=match[1]);try{queryState=this.options.ownerDocument.queryCommandState(action)}catch(exc){queryState=null}return queryState},execAction:function(action,opts){var match,result,fullAction=/^full-(.+)$/gi;return match=fullAction.exec(action),match?(this.saveSelection(),this.selectAllContents(),result=execActionInternal.call(this,match[1],opts),this.restoreSelection()):result=execActionInternal.call(this,action,opts),"insertunorderedlist"!==action&&"insertorderedlist"!==action||MediumEditor.util.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),result},getSelectedParentElement:function(range){return void 0===range&&(range=this.options.contentWindow.getSelection().getRangeAt(0)),MediumEditor.selection.getSelectedParentElement(range)},selectAllContents:function(){var currNode=MediumEditor.selection.getSelectionElement(this.options.contentWindow);if(currNode){for(;1===currNode.children.length;)currNode=currNode.children[0];this.selectElement(currNode)}},selectElement:function(element){MediumEditor.selection.selectNode(element,this.options.ownerDocument);var selElement=MediumEditor.selection.getSelectionElement(this.options.contentWindow);selElement&&this.events.focusElement(selElement)},getFocusedElement:function(){var focused;return this.elements.some(function(element){return!focused&&element.getAttribute("data-medium-focused")&&(focused=element),!!focused},this),focused},exportSelection:function(){var selectionElement=MediumEditor.selection.getSelectionElement(this.options.contentWindow),editableElementIndex=this.elements.indexOf(selectionElement),selectionState=null;return editableElementIndex>=0&&(selectionState=MediumEditor.selection.exportSelection(selectionElement,this.options.ownerDocument)),
null!==selectionState&&0!==editableElementIndex&&(selectionState.editableElementIndex=editableElementIndex),selectionState},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(selectionState,favorLaterSelectionAnchor){if(selectionState){var editableElement=this.elements[selectionState.editableElementIndex||0];MediumEditor.selection.importSelection(selectionState,editableElement,this.options.ownerDocument,favorLaterSelectionAnchor)}},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(opts){var targetUrl,currentEditor=MediumEditor.selection.getSelectionElement(this.options.contentWindow),customEvent={};if(this.elements.indexOf(currentEditor)!==-1){try{if(this.events.disableCustomEvent("editableInput"),opts.url&&MediumEditor.util.deprecated(".url option for createLink",".value","6.0.0"),targetUrl=opts.url||opts.value,targetUrl&&targetUrl.trim().length>0){var currentSelection=this.options.contentWindow.getSelection();if(currentSelection){var exportedSelection,startContainerParentElement,endContainerParentElement,textNodes,currRange=currentSelection.getRangeAt(0),commonAncestorContainer=currRange.commonAncestorContainer;if(3===currRange.endContainer.nodeType&&3!==currRange.startContainer.nodeType&&0===currRange.startOffset&&currRange.startContainer.firstChild===currRange.endContainer&&(commonAncestorContainer=currRange.endContainer),startContainerParentElement=MediumEditor.util.getClosestBlockContainer(currRange.startContainer),endContainerParentElement=MediumEditor.util.getClosestBlockContainer(currRange.endContainer),3!==commonAncestorContainer.nodeType&&0!==commonAncestorContainer.textContent.length&&startContainerParentElement===endContainerParentElement){var parentElement=startContainerParentElement||currentEditor,fragment=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),exportedSelection=this.exportSelection(),fragment.appendChild(parentElement.cloneNode(!0)),currentEditor===parentElement?MediumEditor.selection.select(this.options.ownerDocument,parentElement.firstChild,0,parentElement.lastChild,3===parentElement.lastChild.nodeType?parentElement.lastChild.nodeValue.length:parentElement.lastChild.childNodes.length):MediumEditor.selection.select(this.options.ownerDocument,parentElement,0,parentElement,parentElement.childNodes.length);var modifiedExportedSelection=this.exportSelection();textNodes=MediumEditor.util.findOrCreateMatchingTextNodes(this.options.ownerDocument,fragment,{start:exportedSelection.start-modifiedExportedSelection.start,end:exportedSelection.end-modifiedExportedSelection.start,editableElementIndex:exportedSelection.editableElementIndex}),0===textNodes.length&&(fragment=this.options.ownerDocument.createDocumentFragment(),fragment.appendChild(commonAncestorContainer.cloneNode(!0)),textNodes=[fragment.firstChild.firstChild,fragment.firstChild.lastChild]),MediumEditor.util.createLink(this.options.ownerDocument,textNodes,targetUrl.trim());var leadingWhitespacesCount=(fragment.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;MediumEditor.util.insertHTMLCommand(this.options.ownerDocument,fragment.firstChild.innerHTML.replace(/^\s+/,"")),exportedSelection.start-=leadingWhitespacesCount,exportedSelection.end-=leadingWhitespacesCount,this.importSelection(exportedSelection)}else this.options.ownerDocument.execCommand("createLink",!1,targetUrl);this.options.targetBlank||"_blank"===opts.target?MediumEditor.util.setTargetBlank(MediumEditor.selection.getSelectionStart(this.options.ownerDocument),targetUrl):MediumEditor.util.removeTargetBlank(MediumEditor.selection.getSelectionStart(this.options.ownerDocument),targetUrl),opts.buttonClass&&MediumEditor.util.addClassToAnchors(MediumEditor.selection.getSelectionStart(this.options.ownerDocument),opts.buttonClass)}}if(this.options.targetBlank||"_blank"===opts.target||opts.buttonClass){customEvent=this.options.ownerDocument.createEvent("HTMLEvents"),customEvent.initEvent("input",!0,!0,this.options.contentWindow);for(var i=0,len=this.elements.length;i<len;i+=1)this.elements[i].dispatchEvent(customEvent)}}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",customEvent,currentEditor)}},cleanPaste:function(text){this.getExtensionByName("paste").cleanPaste(text)},pasteHTML:function(html,options){this.getExtensionByName("paste").pasteHTML(html,options)},setContent:function(html,index){if(index=index||0,this.elements[index]){var target=this.elements[index];target.innerHTML=html,this.checkContentChanged(target)}},getContent:function(index){return index=index||0,this.elements[index]?this.elements[index].innerHTML.trim():null},checkContentChanged:function(editable){editable=editable||MediumEditor.selection.getSelectionElement(this.options.contentWindow),this.events.updateInput(editable,{target:editable,currentTarget:editable})},resetContent:function(element){if(element){var index=this.elements.indexOf(element);return void(index!==-1&&this.setContent(initialContent[element.getAttribute("medium-editor-index")],index))}this.elements.forEach(function(el,idx){this.setContent(initialContent[el.getAttribute("medium-editor-index")],idx)},this)},addElements:function(selector){var elements=createElementsArray(selector,this.options.ownerDocument,!0);return 0!==elements.length&&void elements.forEach(function(element){element=initElement.call(this,element,this.id),this.elements.push(element),this.trigger("addElement",{target:element,currentTarget:element},element)},this)},removeElements:function(selector){var elements=createElementsArray(selector,this.options.ownerDocument),toRemove=elements.map(function(el){return el.getAttribute("medium-editor-textarea-id")&&el.parentNode?el.parentNode.querySelector('div[medium-editor-textarea-id="'+el.getAttribute("medium-editor-textarea-id")+'"]'):el});this.elements=this.elements.filter(function(element){return toRemove.indexOf(element)===-1||(this.events.cleanupElement(element),element.getAttribute("medium-editor-textarea-id")&&cleanupTextareaElement(element),this.trigger("removeElement",{target:element,currentTarget:element},element),!1)},this)}},MediumEditor.getEditorFromElement=function(element){var index=element.getAttribute("data-medium-editor-editor-index"),win=element&&element.ownerDocument&&(element.ownerDocument.defaultView||element.ownerDocument.parentWindow);return win&&win._mediumEditors&&win._mediumEditors[index]?win._mediumEditors[index]:null}}(),function(){MediumEditor.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableExtraSpaces:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0}}(),MediumEditor.parseVersionString=function(release){var split=release.split("-"),version=split[0].split("."),preRelease=split.length>1?split[1]:"";return{major:parseInt(version[0],10),minor:parseInt(version[1],10),revision:parseInt(version[2],10),preRelease:preRelease,toString:function(){return[version[0],version[1],version[2]].join(".")+(preRelease?"-"+preRelease:"")}}},MediumEditor.version=MediumEditor.parseVersionString.call(this,{version:"5.22.2"}.version),MediumEditor}())}).call(this,require("_process"))},{_process:13}],13:[function(require,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],14:[function(require,module,exports){var tick,si="function"==typeof setImmediate;tick=si?function(fn){setImmediate(fn)}:function(fn){setTimeout(fn,0)},module.exports=tick},{}],15:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],16:[function(require,module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],17:[function(require,module,exports){(function(process,global){function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"];if(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0===keys.length&&(!array||0==value.length))return braces[0]+base+braces[1];if(recurseTimes<0)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special");ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if(desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]},desc.get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1),str.indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n"))):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0,length=output.reduce(function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);return length>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];i<len;x=args[++i])str+=isNull(x)||!isObject(x)?" "+x:" "+inspect(x);return str},exports.deprecate=function(fn,msg){function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(process.noDeprecation===!0)return fn;var warned=!1;return deprecated};var debugEnviron,debugs={};exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":16,_process:13,inherits:15}],18:[function(require,module,exports){"use strict";function getContents(primaryContainer){var result="",snippets=primaryContainer.querySelectorAll(".w-snippet");return snippets.forEach(function(snippet){result+=snippet.innerHTML}),result}var basicModal=require("basicmodal"),htmlEncode=require("htmlencode").htmlEncode,createButton=require("./createButton");module.exports=function(primaryContainer){var container=document.createElement("div"),btnExport=createButton("","w-btn-export fa fa-code");btnExport.addEventListener("click",function(e){var content=getContents(primaryContainer);basicModal.show({body:"<pre>"+htmlEncode(content)+"</pre>",buttons:{action:{title:"Close",fn:basicModal.close}}})}),container.className="w-bar-container",container.appendChild(btnExport),document.body.appendChild(container)}},{"./createButton":19,basicmodal:2,htmlencode:11}],19:[function(require,module,exports){"use strict";module.exports=function(text,className,id){var button=document.createElement("button");return button.textContent=text,className&&(button.className=className),id&&(button.id=id),button}},{}],20:[function(require,module,exports){"use strict";var createButton=require("./createButton"),getClosest=require("../utils/getClosest");module.exports=function(){var barActions=document.createElement("div"),btnMove=createButton("","w-btn-move fa fa-arrows"),btnDelete=createButton("","w-btn-delete fa fa-trash");return btnDelete.addEventListener("click",function(e){var parent=getClosest(btnDelete,".w-content-container");parent.remove()}),barActions.className="w-actions",barActions.appendChild(btnMove),barActions.appendChild(btnDelete),barActions}},{"../utils/getClosest":26,"./createButton":19}],21:[function(require,module,exports){"use strict";var createContentActions=require("./createContentActions");module.exports=function(content){var container=document.createElement("div"),contentActions=createContentActions();return container.className="w-content-container",container.appendChild(contentActions),container.appendChild(content),container}},{"./createContentActions":20}],22:[function(require,module,exports){"use strict";var createButton=require("./createButton");module.exports=function(snippets){var primaryContainer=document.createElement("div"),container=document.createElement("div"),btnOpen=createButton("","w-btn-open fa fa-angle-left");btnOpen.addEventListener("click",function(e){var btnOpenClass=btnOpen.classList;btnOpenClass.toggle("in"),primaryContainer.classList.toggle("in"),btnOpenClass.contains("in")?(btnOpenClass.remove("fa-angle-left"),btnOpenClass.add("fa-angle-right")):(btnOpenClass.remove("fa-angle-right"),btnOpenClass.add("fa-angle-left"))}),primaryContainer.className="w-aside-container",container.id="snippetsContainer",container.innerHTML=snippets,primaryContainer.appendChild(btnOpen),primaryContainer.appendChild(container),document.body.appendChild(primaryContainer)}},{"./createButton":19}],23:[function(require,module,exports){"use strict";var MediumEditor=require("medium-editor"),dragula=require("dragula"),createEditContainer=require("./components/createEditContainer");module.exports=function(primaryContainer,editorOptions){dragula([primaryContainer,document.getElementById("snippetsContainer")],{copy:function(el,source){return source===document.getElementById("snippetsContainer")},accepts:function(el,target){return target!==document.getElementById("snippetsContainer")},moves:function(e,container,handle){return container.id==primaryContainer.id?handle.classList.contains("w-btn-move"):"snippetsContainer"==container.id}}).on("drop",function(el,container){if(!(el.querySelectorAll(".w-actions").length>0)&&container&&container.id==primaryContainer.id){var parent=el.parentNode,newEl=el.cloneNode(!0),content=newEl.querySelectorAll(".w-snippet")[0];content&&(content.className+=" editable",parent.replaceChild(createEditContainer(content),el),new MediumEditor(content,editorOptions))}})}},{"./components/createEditContainer":21,dragula:9,"medium-editor":12}],24:[function(require,module,exports){"use strict";var createBarActions=require("./components/createBarActions"),createSnippetContainer=require("./components/createSnippetContainer"),dragNDrop=require("./dragNDrop");module.exports=function(containerId,options){var primaryContainer=document.getElementById(containerId),editorOptions=options&&options.editorOptions,snippetsPath=options&&options.snippetsPath;snippetsPath&&fetch(snippetsPath).then(function(response){return response.text()}).then(function(snippets){createSnippetContainer(snippets),createBarActions(primaryContainer)}).then(function(){dragNDrop(primaryContainer,editorOptions)}).catch(function(response){return console.log(response)})}},{"./components/createBarActions":18,"./components/createSnippetContainer":22,"./dragNDrop":23}],25:[function(require,module,exports){"use strict";var init=require("./init");window&&(window.WebEdit=init)},{"./init":24}],26:[function(require,module,exports){"use strict";module.exports=function(elem,selector){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(s){for(var matches=(this.document||this.ownerDocument).querySelectorAll(s),i=matches.length;--i>=0&&matches.item(i)!==this;);return i>-1});elem&&elem!==document;elem=elem.parentNode)if(elem.matches(selector))return elem;return null}},{}]},{},[25]);